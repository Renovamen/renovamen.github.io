import{_ as e,K as a,o as c,m as p,L as n,x as s,z as l}from"./app-cfa4dd7f.js";const t={class:"prose prose-lg m-auto text-left"},r=n('<p>“虽然研究进度堪忧，但鱼还是要摸的”，在这样的理念的驱动下，菜鸡最终折腾出了一个目前看上去还算可以的方案。</p><p>我的博客最初 fork 自 <a href="https://github.com/Huxpro/huxpro.github.io" target="_blank" rel="noopener noreferrer">Huxpro/huxpro.github.io</a>，用了一段时间之后开始瞎改，把别人干净的代码改得乱七八糟。博客用的是 Jekyll 框架，而 Jekyll 就是 Github Pages 的默认引擎，所以在部署的时候 Github Pages 连 build 这一步都帮你省了。于是在很长一段时间内，作为一只懒惰的菜鸡，我并没有什么动力来折腾这些东西。而现在之所以要折腾，是因为不折腾的确不行了。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>不过这版博客已经是用 Vitesse 写的全新的版本了，所以这篇文章中的某些部分已经并不适用了…</p></div><h2 id="奇怪的起因" tabindex="-1">奇怪的起因 <a class="header-anchor" href="#奇怪的起因" aria-hidden="true">#</a></h2><p>说起来这还是一个漫长的故事。首先我的博客的公式渲染引擎用的是 <a href="https://katex.org/" target="_blank" rel="noopener noreferrer">Katex</a>，因为它快，比 Mathjax 快多了（可以参考<a href="https://katex.org/" target="_blank" rel="noopener noreferrer">这里</a>）。</p><p>kramdown 的默认数学公式渲染引擎是 Mathjax，而从 <code>v2.0.0</code> 开始 kramdown 似乎引入了一些插件来支持 Katex，比如 <a href="https://github.com/kramdown/math-katex" target="_blank" rel="noopener noreferrer">kramdown-math-katex</a>。那么问题来了，Github Pages 的 Jekyll 是不支持除了<a href="https://pages.github.com/versions/" target="_blank" rel="noopener noreferrer">这些插件</a>以外的插件的。那么唯一的办法就只有在本地 build 网站，然后把 build 好的文件 push 到 <code>gh-pages</code> 分支上去。</p><p>不行，这样多麻烦，Jekyll 的天生优势不就没了吗，不然我为啥不用 Hexo 或者 Hugo，它们还比 Jekyll 快，不行不行。</p><p>那个时候还没有 Github Actions 这种东西，我又完全不知道别的持续集成方案，就算知道了估计也不想去折腾。于是我在<a href="https://xuc.me/blog/katex-and-jekyll/" target="_blank" rel="noopener noreferrer">这里</a>看到了一个比较 hack 的方法，首先让 kramdown 以为我们要用 Mathjax：</p>',8),y=s("div",{class:"language-yaml"},[s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark-dimmed has-highlighted-lines shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"markdown"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"kramdown"),s("span",{style:{color:"#ADBAC7"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"kramdown"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line highlighted"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"math_engine"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"mathjax")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light has-highlighted-lines shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"markdown"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"kramdown"),s("span",{style:{color:"#24292E"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"kramdown"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line highlighted"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"math_engine"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"mathjax")]),l(`
`),s("span",{class:"line"})])])],-1),i=s("p",null,[l("这样 kramdown 就会把像 "),s("code",null,"$$a + b$$"),l(" 这样的公式转换成 Mathjax 能识别的 HTML 形式：")],-1),A=s("div",{class:"language-js"},[s("span",{class:"lang"},"js"),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"<"),s("span",{style:{color:"#8DDB8C"}},"script"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"type"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#96D0FF"}},'"math/tex"'),s("span",{style:{color:"#ADBAC7"}},">a + b</"),s("span",{style:{color:"#8DDB8C"}},"script"),s("span",{style:{color:"#ADBAC7"}},">")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"<"),s("span",{style:{color:"#22863A"}},"script"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"type"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},'"math/tex"'),s("span",{style:{color:"#24292E"}},">a + b</"),s("span",{style:{color:"#22863A"}},"script"),s("span",{style:{color:"#24292E"}},">")]),l(`
`),s("span",{class:"line"})])])],-1),D=s("p",null,[l("然后通过 JavaScript 把 "),s("code",null,'<script type="math/tex">'),l(" 标签里的东西用 Katex 渲染出来：")],-1),d=s("div",{class:"language-js"},[s("span",{class:"lang"},"js"),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#DCBDFB"}},"$"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#96D0FF"}},`"script[type='math/tex']"`),s("span",{style:{color:"#ADBAC7"}},")."),s("span",{style:{color:"#DCBDFB"}},"replaceWith"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#F47067"}},"function"),s("span",{style:{color:"#ADBAC7"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#F47067"}},"var"),s("span",{style:{color:"#ADBAC7"}}," tex "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"$"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#6CB6FF"}},"this"),s("span",{style:{color:"#ADBAC7"}},")."),s("span",{style:{color:"#DCBDFB"}},"text"),s("span",{style:{color:"#ADBAC7"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," katex."),s("span",{style:{color:"#DCBDFB"}},"renderToString"),s("span",{style:{color:"#ADBAC7"}},"(tex, {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    displayMode: "),s("span",{style:{color:"#6CB6FF"}},"false")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  });")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"});")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCBDFB"}},"$"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#96D0FF"}},`"script[type='math/tex; mode=display']"`),s("span",{style:{color:"#ADBAC7"}},")."),s("span",{style:{color:"#DCBDFB"}},"replaceWith"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#F47067"}},"function"),s("span",{style:{color:"#ADBAC7"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#F47067"}},"var"),s("span",{style:{color:"#ADBAC7"}}," tex "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"$"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#6CB6FF"}},"this"),s("span",{style:{color:"#ADBAC7"}},")."),s("span",{style:{color:"#DCBDFB"}},"html"),s("span",{style:{color:"#ADBAC7"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," katex."),s("span",{style:{color:"#DCBDFB"}},"renderToString"),s("span",{style:{color:"#ADBAC7"}},"(tex."),s("span",{style:{color:"#DCBDFB"}},"replace"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#96D0FF"}},"/%"),s("span",{style:{color:"#6CB6FF"}},"."),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#96D0FF"}},"/"),s("span",{style:{color:"#F47067"}},"g"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#96D0FF"}},"''"),s("span",{style:{color:"#ADBAC7"}},"), {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    displayMode: "),s("span",{style:{color:"#6CB6FF"}},"true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  });")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"});")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#6F42C1"}},"$"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#032F62"}},`"script[type='math/tex']"`),s("span",{style:{color:"#24292E"}},")."),s("span",{style:{color:"#6F42C1"}},"replaceWith"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#D73A49"}},"function"),s("span",{style:{color:"#24292E"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#D73A49"}},"var"),s("span",{style:{color:"#24292E"}}," tex "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"$"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#005CC5"}},"this"),s("span",{style:{color:"#24292E"}},")."),s("span",{style:{color:"#6F42C1"}},"text"),s("span",{style:{color:"#24292E"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," katex."),s("span",{style:{color:"#6F42C1"}},"renderToString"),s("span",{style:{color:"#24292E"}},"(tex, {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    displayMode: "),s("span",{style:{color:"#005CC5"}},"false")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  });")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"});")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6F42C1"}},"$"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#032F62"}},`"script[type='math/tex; mode=display']"`),s("span",{style:{color:"#24292E"}},")."),s("span",{style:{color:"#6F42C1"}},"replaceWith"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#D73A49"}},"function"),s("span",{style:{color:"#24292E"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#D73A49"}},"var"),s("span",{style:{color:"#24292E"}}," tex "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"$"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#005CC5"}},"this"),s("span",{style:{color:"#24292E"}},")."),s("span",{style:{color:"#6F42C1"}},"html"),s("span",{style:{color:"#24292E"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," katex."),s("span",{style:{color:"#6F42C1"}},"renderToString"),s("span",{style:{color:"#24292E"}},"(tex."),s("span",{style:{color:"#6F42C1"}},"replace"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#032F62"}},"/%"),s("span",{style:{color:"#005CC5"}},"."),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#032F62"}},"/"),s("span",{style:{color:"#D73A49"}},"g"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#032F62"}},"''"),s("span",{style:{color:"#24292E"}},"), {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    displayMode: "),s("span",{style:{color:"#005CC5"}},"true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  });")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"});")]),l(`
`),s("span",{class:"line"})])])],-1),h=n('<p>虽然看上去不太优雅，但好歹能用，本菜鸡的理念是能用就行，于是就这样过了一段时间。直到几个月前，我发现我博客的公式不对劲了，它们突然都变成了这样：<code>\\(a + b\\)</code>。</p><p>我一脸懵逼，第一反应是我是不是又把博客哪儿的代码搞崩了，但想了想我似乎也没有动过公式那部分的代码？而且当时我部署在 Coding Pages 上的博客公式还是正常的，那么大概率就是 Github Pages 哪里不对劲了。</p><p>搜了一下发现 Github Pages 把 kramdown 的版本更新到了 <code>v2.2.0</code>，从这一版开始，为了兼容 Mathjax <code>v3.x</code>，kramdown 会把 inline math 转换成 <code>\\(a + b\\)</code> 的形式，把 block math 转换成 <code>\\[a + b\\]</code> 的形式（参考<a href="https://github.com/gettalong/kramdown/commit/c3acf8df1db49d2456050f4456f3f542294e2e8f" target="_blank" rel="noopener noreferrer">这个 commit</a>），于是上面那段脚本就坏掉了。</p><p>于是一切都回到了最初的起点，摆在面前的办法只剩下把在本地用 kramdown <code>v2.1.0</code> build 好的网站扔 <code>gh-pages</code> 上去。这样干了几个月后懒惰的我实在忍不了了，并决定让 Github Actions 来帮我干这件事。</p><p>所以我当初为啥不选 Hexo…</p><h2 id="github-actions" tabindex="-1">Github Actions <a class="header-anchor" href="#github-actions" aria-hidden="true">#</a></h2><p>在 repo 下建一个目录 <code>.github/workflow</code>，在这个目录下放一个 <code>.yaml</code> 格式的 workflow 文件。GitHub 只要发现 <code>.github/workflows</code> 下有 <code>.yaml</code> 文件，就会自动运行它们。<a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-syntax-for-github-actions" target="_blank" rel="noopener noreferrer">这里</a>是 workflow 文件的详细文档。</p><h3 id="jekyll" tabindex="-1">Jekyll <a class="header-anchor" href="#jekyll" aria-hidden="true">#</a></h3><p><a href="https://jekyllrb.com/docs/continuous-integration/github-actions/" target="_blank" rel="noopener noreferrer">Jekyll 官方</a>已经给了一个现成的 <a href="https://github.com/helaili/jekyll-action" target="_blank" rel="noopener noreferrer">action</a>，直接引用它就好：</p>',9),C=s("div",{class:"language-yaml"},[s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"build Jekyll site and deploy it to GitHub Pages")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#768390"}},"# 检测 master 分支上的推送和 pr")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6CB6FF"}},"on"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"push"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"branches"),s("span",{style:{color:"#ADBAC7"}},": [ "),s("span",{style:{color:"#96D0FF"}},"master"),s("span",{style:{color:"#ADBAC7"}}," ]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"pull_request"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"branches"),s("span",{style:{color:"#ADBAC7"}},": [ "),s("span",{style:{color:"#96D0FF"}},"master"),s("span",{style:{color:"#ADBAC7"}}," ]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"jobs"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"jekyll-build-and-deploy"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"runs-on"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"ubuntu-latest")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"steps"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/checkout@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# 检测 vendor/bundle 下有没有已经安装好的包")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# 如果有的话就不用再 bundle install 了，节省时间和资源")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"check cache")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/cache@v1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"path"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"vendor/bundle")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"key"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"runner.os−gems−{%raw%}{{ hashFiles('**/Gemfile.lock') }}{% endraw %}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"restore-keys"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"            ${{ runner.os }}-gems-")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# 引用 helaili/jekyll-action 来打包 Jekyll 网站")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# 并把打包好的文件推到同一个 repo 的 gh-pages 分支")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"build and deploy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"helaili/jekyll-action@2.0.4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"env"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"JEKYLL_PAT"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"target_branch"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"'gh-pages'")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"build Jekyll site and deploy it to GitHub Pages")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 检测 master 分支上的推送和 pr")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"on"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"push"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},": [ "),s("span",{style:{color:"#032F62"}},"master"),s("span",{style:{color:"#24292E"}}," ]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"pull_request"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},": [ "),s("span",{style:{color:"#032F62"}},"master"),s("span",{style:{color:"#24292E"}}," ]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"jobs"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"jekyll-build-and-deploy"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"runs-on"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ubuntu-latest")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"steps"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/checkout@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# 检测 vendor/bundle 下有没有已经安装好的包")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# 如果有的话就不用再 bundle install 了，节省时间和资源")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"check cache")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/cache@v1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"path"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"vendor/bundle")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"key"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"runner.os−gems−{%raw%}{{ hashFiles('**/Gemfile.lock') }}{% endraw %}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"restore-keys"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            ${{ runner.os }}-gems-")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# 引用 helaili/jekyll-action 来打包 Jekyll 网站")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# 并把打包好的文件推到同一个 repo 的 gh-pages 分支")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"build and deploy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"helaili/jekyll-action@2.0.4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"env"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"JEKYLL_PAT"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"target_branch"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"'gh-pages'")]),l(`
`),s("span",{class:"line"})])])],-1),B=n("<p>相当于这个 workflow 会自动检测 <code>master</code> 分支上的 push 和 pull_request，一旦检测就到准备环境，然后运行 <code>bundle exec jekyll build</code> 打包网站，并把打包产物扔 <code>gh-pages</code> 分支上去。</p><p>需要注意的是必须得有一个 <code>Gemfile</code> 和 <code>Gemfile.lock</code> 文件，<code>Gemfile</code> 里面写上要装的包，比如本博客的 <code>Gemfile</code> 长这样：</p>",2),F=s("div",{class:"language-ruby"},[s("span",{class:"lang"},"ruby"),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"source "),s("span",{style:{color:"#96D0FF"}},"'https://rubygems.org'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"gem "),s("span",{style:{color:"#96D0FF"}},"'jekyll'"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#96D0FF"}},"'~> 4.0'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"gem "),s("span",{style:{color:"#96D0FF"}},"'kramdown'"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#96D0FF"}},"'= 2.1.0'"),s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#768390"}},"# 这里为了 Katex 把 kramdown 版本固定在了 2.1.0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"gem "),s("span",{style:{color:"#96D0FF"}},"'jemoji'"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#96D0FF"}},"'~> 0.11.1'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"gem "),s("span",{style:{color:"#96D0FF"}},"'jekyll-paginate'"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#96D0FF"}},"'~> 1.1.0'")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"source "),s("span",{style:{color:"#032F62"}},"'https://rubygems.org'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"gem "),s("span",{style:{color:"#032F62"}},"'jekyll'"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#032F62"}},"'~> 4.0'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"gem "),s("span",{style:{color:"#032F62"}},"'kramdown'"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#032F62"}},"'= 2.1.0'"),s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#6A737D"}},"# 这里为了 Katex 把 kramdown 版本固定在了 2.1.0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"gem "),s("span",{style:{color:"#032F62"}},"'jemoji'"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#032F62"}},"'~> 0.11.1'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"gem "),s("span",{style:{color:"#032F62"}},"'jekyll-paginate'"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#032F62"}},"'~> 1.1.0'")]),l(`
`),s("span",{class:"line"})])])],-1),u=n('<p>如果用了自定义域名，那就还需要在 <code>master</code> 分支放一个 <code>CNAME</code>，这样 <a href="https://github.com/helaili/jekyll-action" target="_blank" rel="noopener noreferrer">helaili/jekyll-action</a> 就会把 <code>CNAME</code> 也推到 <code>gh-pages</code> 分支去。直接在 <code>gh-pages</code> 分支加 <code>CNAME</code> 是没有什么用的，因为下次自动推送时它就会被清掉…</p><h3 id="node-js" tabindex="-1">Node.js <a class="header-anchor" href="#node-js" aria-hidden="true">#</a></h3><p>所有能用 Node.js 搞定的东西（比如这个基于 VuePress 的博客）都能用以下工作流处理：</p><h4 id="npm" tabindex="-1">npm <a class="header-anchor" href="#npm" aria-hidden="true">#</a></h4>',4),E=s("div",{class:"language-yaml"},[s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"build and deploy")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#768390"}},"# 检测 master 分支上的推送和 pr")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6CB6FF"}},"on"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"push"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"branches"),s("span",{style:{color:"#ADBAC7"}},": [ "),s("span",{style:{color:"#96D0FF"}},"master"),s("span",{style:{color:"#ADBAC7"}}," ]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"pull_request"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"branches"),s("span",{style:{color:"#ADBAC7"}},": [ "),s("span",{style:{color:"#96D0FF"}},"master"),s("span",{style:{color:"#ADBAC7"}}," ]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"jobs"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"build-and-deploy-vuepress"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"runs-on"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"ubuntu-latest")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"steps"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/checkout@v2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# Node.js 环境")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Setup Node")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/setup-node@v2.1.2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"node-version"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"'12.x'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Cache dependencies")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/cache@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"path"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"~/.npm")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"key"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"restore-keys"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"            ${{ runner.os }}-node-")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# npm run build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"run"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"          npm ci")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"          npm run build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      "),s("span",{style:{color:"#768390"}},"# 推送到同一个 repo 的 gh-pages 分支")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Deploy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"peaceiris/actions-gh-pages@v3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"github_token"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"publish_dir"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"dist"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#768390"}},"# build 输出文件夹")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"cname"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"zxh.io"),s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#768390"}},"# 如果用了自定义域名，在这里设置")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"build and deploy")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 检测 master 分支上的推送和 pr")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"on"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"push"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},": [ "),s("span",{style:{color:"#032F62"}},"master"),s("span",{style:{color:"#24292E"}}," ]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"pull_request"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},": [ "),s("span",{style:{color:"#032F62"}},"master"),s("span",{style:{color:"#24292E"}}," ]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"jobs"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"build-and-deploy-vuepress"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"runs-on"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ubuntu-latest")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"steps"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/checkout@v2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# Node.js 环境")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Setup Node")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/setup-node@v2.1.2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"node-version"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"'12.x'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Cache dependencies")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/cache@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"path"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"~/.npm")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"key"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"restore-keys"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            ${{ runner.os }}-node-")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# npm run build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"run"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"          npm ci")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"          npm run build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#6A737D"}},"# 推送到同一个 repo 的 gh-pages 分支")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Deploy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"peaceiris/actions-gh-pages@v3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"github_token"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"publish_dir"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"dist"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6A737D"}},"# build 输出文件夹")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"cname"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"zxh.io"),s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#6A737D"}},"# 如果用了自定义域名，在这里设置")]),l(`
`),s("span",{class:"line"})])])],-1),m=s("p",null,[l("其中 "),s("a",{href:"https://github.com/peaceiris/actions-gh-pages",target:"_blank",rel:"noopener noreferrer"},"peaceiris/actions-gh-pages"),l(" 也是一个别人写好的 action，能把指定路径的文件推到 "),s("code",null,"gh-pages"),l(" 分支。")],-1),g=s("h4",{id:"yarn",tabindex:"-1"},[l("yarn "),s("a",{class:"header-anchor",href:"#yarn","aria-hidden":"true"},"#")],-1),b=s("p",null,[l("如果包管理工具用的 "),s("code",null,"yarn"),l("：")],-1),k=s("div",{class:"language-yaml"},[s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"build and deploy")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6CB6FF"}},"on"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"push"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"branches"),s("span",{style:{color:"#ADBAC7"}},": [ "),s("span",{style:{color:"#96D0FF"}},"master"),s("span",{style:{color:"#ADBAC7"}}," ]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"pull_request"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"branches"),s("span",{style:{color:"#ADBAC7"}},": [ "),s("span",{style:{color:"#96D0FF"}},"master"),s("span",{style:{color:"#ADBAC7"}}," ]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8DDB8C"}},"jobs"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"  "),s("span",{style:{color:"#8DDB8C"}},"build-and-deploy-vuepress"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"runs-on"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"ubuntu-latest")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#8DDB8C"}},"steps"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/checkout@v2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Setup Node")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/setup-node@v2.1.2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"node-version"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"'12'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Get yarn cache")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"id"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"yarn-cache")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"run"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},'echo "::set-output name=dir::$(yarn cache dir)"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Cache dependencies")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"actions/cache@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"path"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"${{ steps.yarn-cache.outputs.dir }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"key"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"restore-keys"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"            ${{ runner.os }}-yarn-")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"run"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"          yarn install --frozen-lockfile")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"          yarn build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#96D0FF"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"      - "),s("span",{style:{color:"#8DDB8C"}},"name"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"Deploy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"uses"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"peaceiris/actions-gh-pages@v3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#8DDB8C"}},"with"),s("span",{style:{color:"#ADBAC7"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"github_token"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"publish_dir"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"dist")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"          "),s("span",{style:{color:"#8DDB8C"}},"cname"),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#96D0FF"}},"zxh.io")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"build and deploy")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"on"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"push"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},": [ "),s("span",{style:{color:"#032F62"}},"master"),s("span",{style:{color:"#24292E"}}," ]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"pull_request"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},": [ "),s("span",{style:{color:"#032F62"}},"master"),s("span",{style:{color:"#24292E"}}," ]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"jobs"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"build-and-deploy-vuepress"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"runs-on"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ubuntu-latest")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"steps"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/checkout@v2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Setup Node")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/setup-node@v2.1.2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"node-version"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"'12'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Get yarn cache")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"id"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"yarn-cache")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"run"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},'echo "::set-output name=dir::$(yarn cache dir)"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Cache dependencies")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/cache@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"path"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ steps.yarn-cache.outputs.dir }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"key"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"restore-keys"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            ${{ runner.os }}-yarn-")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"run"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"          yarn install --frozen-lockfile")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"          yarn build")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Deploy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"peaceiris/actions-gh-pages@v3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"github_token"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"publish_dir"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"dist")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"cname"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"zxh.io")]),l(`
`),s("span",{class:"line"})])])],-1),_=n('<h2 id="优化" tabindex="-1">优化 <a class="header-anchor" href="#优化" aria-hidden="true">#</a></h2><h3 id="减少依赖" tabindex="-1">减少依赖 <a class="header-anchor" href="#减少依赖" aria-hidden="true">#</a></h3><p>通过砍掉一些觉得用不太上的功能，和直接手写一些比较简单的功能，去掉了一些依赖。但我已经忘了去掉了哪些了…</p><h3 id="合并依赖" tabindex="-1">合并依赖 <a class="header-anchor" href="#合并依赖" aria-hidden="true">#</a></h3><p>为了减少请求次数，可以尽量把多个 JS 或 CSS 文件合并压缩成一个。上 Gulp 之类的工具当然也可以，不过 jsDelivr 自带了合并功能，比如要合并以下两个库：</p><ul><li><a href="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js" target="_blank" rel="noopener noreferrer">https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js</a></li><li><a href="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js" target="_blank" rel="noopener noreferrer">https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js</a></li></ul><p>只需要：</p>',7),v=s("div",{class:"language-"},[s("span",{class:"lang"}),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#adbac7"}},"https://cdn.jsdelivr.net/combine/npm/chart.js@2.9.3/dist/Chart.min.js,npm/mermaid@8.4.8/dist/mermaid.min.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#adbac7"}})])])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292e"}},"https://cdn.jsdelivr.net/combine/npm/chart.js@2.9.3/dist/Chart.min.js,npm/mermaid@8.4.8/dist/mermaid.min.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292e"}})])])])],-1),x=s("p",null,[l("于是我把除了 Katex 和 Mathjax（因为这俩涉及到引用字体的问题）以外的文件都合并成了一个 "),s("code",null,"lib.min.js"),l("。")],-1),f=s("h3",{id:"cdn",tabindex:"-1"},[l("CDN "),s("a",{class:"header-anchor",href:"#cdn","aria-hidden":"true"},"#")],-1),j=s("p",null,"又一次喜闻乐见的白嫖 jsDelivr，对于托管在 Github 上的博客来说，在静态资源路径前加上以下 URL 即可：",-1),w=s("div",{class:"language-"},[s("span",{class:"lang"}),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#adbac7"}},"https://cdn.jsdelivr.net/gh/{{ 用户名 }}/{{ 仓库名 }}@{{ 分支名 }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#adbac7"}})])])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292e"}},"https://cdn.jsdelivr.net/gh/{{ 用户名 }}/{{ 仓库名 }}@{{ 分支名 }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292e"}})])])])],-1),$=s("p",null,"比如：",-1),G=s("div",{class:"language-"},[s("span",{class:"lang"}),s("pre",{class:"shiki github-dark-dimmed shiki-dark",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#adbac7"}},"https://cdn.jsdelivr.net/gh/Renovamen/renovamen.github.io@master/js/lib.min.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#adbac7"}})])])]),s("pre",{class:"shiki github-light shiki-light",tabindex:"0"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292e"}},"https://cdn.jsdelivr.net/gh/Renovamen/renovamen.github.io@master/js/lib.min.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292e"}})])])])],-1),N=n('<h2 id="vercel" tabindex="-1">Vercel <a class="header-anchor" href="#vercel" aria-hidden="true">#</a></h2><p>我一直以来都在听说双线部署甚至多线部署这种提高访问速度的操作，但一直没有去折腾。因为 Github Pages 虽然境内访问慢了点，但至少还是能访问的，那么能用就行了。直到几个月前，我发现 Github Pages 境内完全访问不上了…</p><p>间歇性抽风想想还是很让人不安，那行吧行吧双线部署我来了…</p><p>那时候我所知的有境内节点的静态网站托管服务就 <a href="https://gitee.com/help/articles/4136" target="_blank" rel="noopener noreferrer">Gitee Pages</a> 和 <a href="https://help.coding.net/docs/devops/cd/static-website.html" target="_blank" rel="noopener noreferrer">Coding Pages</a> 俩，而 Gitee Pages 不能免费自定义域名，于是就把境内的线路解析到了 Coding Pages 上。</p><p>然而不久之前，新版 Coding Pages 的静态网站合并到腾讯云静态网站，并开始收费了。之前旧版的静态网站还能正常部署和访问，但之后的网站就都得用新版。收费倒是并不贵且也没有什么问题，问题在于如果域名不备案的话，即使是境内的访问，Coding 也会强制给你上境外 CDN 加速，于是速度会很慢，估计比直接访问 Github Pages 还慢。</p><p>于是就手忙脚乱的把境内线路的博客扔到了 Vercel 上。只能说 Vercel 至少到目前为止还没发现什么毛病，有境内节点（不过感觉还是没有以前的 Coding Pages 快？），而且是直接自动从 Github 仓库上拉代码然后打包加部署，对菜鸡相当友好。</p><p>以前为啥就没发现呢。</p>',7),P=[r,y,i,A,D,d,h,C,B,F,u,E,m,g,b,k,_,v,x,f,j,w,$,G,N],V="关于博客的碎碎念",q=["摸鱼"],I=[{property:"og:title",content:"关于博客的碎碎念"}],T={__name:"2020-10-07-my-blog",setup(H,{expose:o}){return o({frontmatter:{title:"关于博客的碎碎念",tags:["摸鱼"],meta:[{property:"og:title",content:"关于博客的碎碎念"}]}}),a({title:"关于博客的碎碎念",meta:[{property:"og:title",content:"关于博客的碎碎念"}]}),(M,S)=>(c(),p("div",t,P))}},L=e(T,[["__file","/home/runner/work/renovamen.github.io/renovamen.github.io/pages/posts/zh/2020-10-07-my-blog.md"]]);export{L as default,I as meta,q as tags,V as title};
