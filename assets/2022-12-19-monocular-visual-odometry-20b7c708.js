import{_ as p,K as t,o as e,m as o,L as l,x as s,z as a}from"./app-c4e7edd9.js";const r={class:"prose prose-lg m-auto text-left"},c=l('<p><div class="table-of-contents"><ul><li><a href="#problem">Problem </a></li><li><a href="#feature-detection">Feature Detection </a></li><li><a href="#feature-tracking">Feature Tracking </a></li><li><a href="#fundamental-matrix">Fundamental Matrix </a><ul><li><a href="#eight-point-algorithm">Eight Point Algorithm </a></li><li><a href="#ransac">RANSAC </a></li></ul></li><li><a href="#essential-matrix">Essential Matrix </a></li><li><a href="#camera-pose">Camera Pose </a></li><li><a href="#trajectory">Trajectory </a></li><li><a href="#references">References </a></li></ul></div></p><p>Monocular Visual Odometry (VO) is the process of estimating the pose (position and orientation) of a camera using only visual information from a single camera. It is a crucial component of many robotics and augmented reality systems, as it allows a device to understand its own movement and position in the world.</p><p>This blog would be focussing on how to implement a simple monocular VO algorithm in Python. If you are new to it, I suggest having a look at <a href="https://cmsc426.github.io/sfm/" target="_blank" rel="noopener noreferrer">this article</a>.</p><p>The overall process can be broken down into the following steps:</p><ul><li>Feature detection</li><li>Feature tracking</li><li>Estimating fundamental matrix</li><li>Estimating essential matrix (from fundamental matrix)</li><li>Recovering pose (from essential matrix)</li></ul><h2 id="problem" tabindex="-1">Problem <a class="header-anchor" href="#problem" aria-hidden="true">#</a></h2><p>Suppose that we have a camera attached to a vehicle. A video coming from this camera has been processed for lens distortion and converted to frames. We denote the frames captured at time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>, respectively. For every pair of images <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, our job is to find the rotation matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and the translation vector <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, which describe the motion of the vehicle between the two frames.</p><h2 id="feature-detection" tabindex="-1">Feature Detection <a class="header-anchor" href="#feature-detection" aria-hidden="true">#</a></h2><p>We first look for salient landmarks, called keypoints <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Keypoints are features that differ from their immediate neighborhood such as corners or areas with unique colors or textures. These features should ideally be found in both two adjacent frames.</p><p>Using OpenCV, detecting keypoints is trivial:</p>',10),i=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"import"),s("span",{style:{color:"#ADBAC7"}}," cv2")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"detect_features"),s("span",{style:{color:"#ADBAC7"}},"(image):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    detector "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," cv2.GFTTDetector_create()")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    kp "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," detector.detect(image)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    kp "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," cv2.KeyPoint_convert("),s("span",{style:{color:"#6CB6FF"}},"sorted"),s("span",{style:{color:"#ADBAC7"}},"(kp, "),s("span",{style:{color:"#F69D50"}},"key"),s("span",{style:{color:"#F47067"}},"=lambda"),s("span",{style:{color:"#ADBAC7"}}," p: p.response, "),s("span",{style:{color:"#F69D50"}},"reverse"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"True"),s("span",{style:{color:"#ADBAC7"}},"))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," kp")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"kp1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," detect_features(image1)")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," cv2")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"detect_features"),s("span",{style:{color:"#24292E"}},"(image):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    detector "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," cv2.GFTTDetector_create()")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    kp "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," detector.detect(image)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    kp "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," cv2.KeyPoint_convert("),s("span",{style:{color:"#005CC5"}},"sorted"),s("span",{style:{color:"#24292E"}},"(kp, "),s("span",{style:{color:"#E36209"}},"key"),s("span",{style:{color:"#D73A49"}},"=lambda"),s("span",{style:{color:"#24292E"}}," p: p.response, "),s("span",{style:{color:"#E36209"}},"reverse"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"True"),s("span",{style:{color:"#24292E"}},"))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," kp")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"kp1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," detect_features(image1)")]),a(`
`),s("span",{class:"line"})])])],-1),y=l('<p>Here GFTT (Good Features to Track) detector is used to detect keypoints. In my experiments, other detectors like SIFT (Scale Invariant Feature Transform) and ORB (Oriented Fast and Rotated Brief) perform worse than GFTT. Meanwhile, the speed of SIFT is much slower.</p><h2 id="feature-tracking" tabindex="-1">Feature Tracking <a class="header-anchor" href="#feature-tracking" aria-hidden="true">#</a></h2><p>We then need to track <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>’s corresponding keypoints <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> using optical flow. To improve the performance, you can choose to remove the keypoints that are not tracked in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> (<code>status</code> returned by <code>cv2.calcOpticalFlowPyrLK</code> is 0) or are outside <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>.</p>',3),m=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"get_removed_pts_ids"),s("span",{style:{color:"#ADBAC7"}},"(pts, image, status):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Removes keypoints that are not tracked or are outside the image."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    status_ "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," status.copy()")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," idx, pt "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"enumerate"),s("span",{style:{color:"#ADBAC7"}},"(pts):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," pt["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"<"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"or"),s("span",{style:{color:"#ADBAC7"}}," pt["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"<"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"or"),s("span",{style:{color:"#ADBAC7"}}," pt["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},">"),s("span",{style:{color:"#ADBAC7"}}," image.shape["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"or"),s("span",{style:{color:"#ADBAC7"}}," pt["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},">"),s("span",{style:{color:"#ADBAC7"}}," image.shape["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            status_[idx] "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," np.where(status_ "),s("span",{style:{color:"#F47067"}},"=="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},")["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"track_features"),s("span",{style:{color:"#ADBAC7"}},"(image1, image2, kp1, remove_outliers: "),s("span",{style:{color:"#6CB6FF"}},"bool"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"False"),s("span",{style:{color:"#ADBAC7"}},"):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Tracks features using optical flow."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    kp2, status, _ "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," cv2.calcOpticalFlowPyrLK(image1, image2, kp1, "),s("span",{style:{color:"#6CB6FF"}},"None"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," remove_outliers:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        removed_ids "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," get_removed_pts_ids(kp2, image2, status)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        kp1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.delete(kp1, removed_ids, "),s("span",{style:{color:"#F69D50"}},"axis"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        kp2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.delete(kp2, removed_ids, "),s("span",{style:{color:"#F69D50"}},"axis"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," kp1, kp2")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"kp1, kp2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," track_features(image1, image2, kp1, "),s("span",{style:{color:"#F69D50"}},"remove_outliers"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"True"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"get_removed_pts_ids"),s("span",{style:{color:"#24292E"}},"(pts, image, status):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Removes keypoints that are not tracked or are outside the image."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    status_ "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," status.copy()")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," idx, pt "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"enumerate"),s("span",{style:{color:"#24292E"}},"(pts):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," pt["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"<"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"or"),s("span",{style:{color:"#24292E"}}," pt["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"<"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"or"),s("span",{style:{color:"#24292E"}}," pt["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},">"),s("span",{style:{color:"#24292E"}}," image.shape["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"or"),s("span",{style:{color:"#24292E"}}," pt["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},">"),s("span",{style:{color:"#24292E"}}," image.shape["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            status_[idx] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," np.where(status_ "),s("span",{style:{color:"#D73A49"}},"=="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},")["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"track_features"),s("span",{style:{color:"#24292E"}},"(image1, image2, kp1, remove_outliers: "),s("span",{style:{color:"#005CC5"}},"bool"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"False"),s("span",{style:{color:"#24292E"}},"):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Tracks features using optical flow."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    kp2, status, _ "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," cv2.calcOpticalFlowPyrLK(image1, image2, kp1, "),s("span",{style:{color:"#005CC5"}},"None"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," remove_outliers:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        removed_ids "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," get_removed_pts_ids(kp2, image2, status)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        kp1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.delete(kp1, removed_ids, "),s("span",{style:{color:"#E36209"}},"axis"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        kp2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.delete(kp2, removed_ids, "),s("span",{style:{color:"#E36209"}},"axis"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," kp1, kp2")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"kp1, kp2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," track_features(image1, image2, kp1, "),s("span",{style:{color:"#E36209"}},"remove_outliers"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"True"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"})])])],-1),h=l(`<h2 id="fundamental-matrix" tabindex="-1">Fundamental Matrix <a class="header-anchor" href="#fundamental-matrix" aria-hidden="true">#</a></h2><p>The fundamental matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">23</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">33</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span> is a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> matrix that encodes the relative orientation and position of the camera between <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>.</p><h3 id="eight-point-algorithm" tabindex="-1">Eight Point Algorithm <a class="header-anchor" href="#eight-point-algorithm" aria-hidden="true">#</a></h3><p>To estimate <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, one of the solutions is <a href="https://www.cs.cmu.edu/~16385/s17/Slides/12.4_8Point_Algorithm.pdf" target="_blank" rel="noopener noreferrer">Hartley’s normalized 8-point algorithm</a>, where the constraint for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> is:</p><p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.8001em;vertical-align:-5.1501em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewBox="0 0 667 4200"><path d="M403 1759 V84 H666 V0 H319 V1759 v600 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v600 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.317em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewBox="0 0 667 4200"><path d="M347 1759 V0 H0 V84 H263 V1759 v600 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v600 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.6499em;"><span style="top:-7.6499em;"><span class="pstrut" style="height:12.8em;"></span><span style="width:0.667em;height:10.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="10.800em" viewBox="0 0 667 10800"><path d="M403 1759 V84 H666 V0 H319 V1759 v7200 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v7200 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.1501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.65em;"><span style="top:-7.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">23</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:0.59em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:1.79em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">33</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.6499em;"><span style="top:-7.6499em;"><span class="pstrut" style="height:12.8em;"></span><span style="width:0.667em;height:10.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="10.800em" viewBox="0 0 667 10800"><path d="M347 1759 V0 H0 V84 H263 V1759 v7200 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v7200 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.1501em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span></span></p><p>which can be answered by solving the linear least squares using Singular Value Decomposition (SVD). This algorithm requires 8 keypoint correspondences exists, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> are the coordinates of the 8 keypoints selected from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> are the coordinates of their corresponding keypoints in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>. The coordinates should be normalized by shifting them around the mean of the points and enclosing them at a distance of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1328em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span></span> from the new center.</p><p>Given 8 keypoint correspondences, the code for computing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> is:</p>`,7),g=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"import"),s("span",{style:{color:"#ADBAC7"}}," numpy "),s("span",{style:{color:"#F47067"}},"as"),s("span",{style:{color:"#ADBAC7"}}," np")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"normalize"),s("span",{style:{color:"#ADBAC7"}},"(pt: np.ndarray):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Normalizes the given set of points."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    N "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," pt.shape["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    mean "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," pt "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," np.mean(pt, "),s("span",{style:{color:"#F69D50"}},"axis"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    scale "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.sum(np.square(pt)) "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," ("),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," N)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    scale "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.sqrt("),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," scale)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," scale "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," mean, scale")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"compute_fundamental_mat"),s("span",{style:{color:"#ADBAC7"}},"(pt1: np.ndarray, pt2: np.ndarray)-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Computes the fundamental matrix F using SVD."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    N "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," pt1.shape["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    norm_pt1, scale1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," normalize(pt1)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    norm_pt2, scale2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," normalize(pt2)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    T1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.array([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        [scale1, "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," scale1 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," np.mean(pt1[:, "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", scale1, "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," scale1 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," np.mean(pt1[:, "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    ])")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    T2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.array([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        [scale2, "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," scale2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," np.mean(pt2[:, "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", scale2, "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," scale2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," np.mean(pt2[:, "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    ])")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    A "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," []")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," i "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"range"),s("span",{style:{color:"#ADBAC7"}},"(N):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        x1, y1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," norm_pt1[i]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        x2, y2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," norm_pt2[i]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        a "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.array([x2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," x1, x2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," y1, x2, y2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," x1, y2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," y1, y2, x1, y1, "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        A.append(a)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    A "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.array(A)  "),s("span",{style:{color:"#768390"}},"# (N, 9)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    U1, S1, V1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.linalg.svd(A)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," V1["),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},",:].reshape("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    F "),s("span",{style:{color:"#F47067"}},"/="),s("span",{style:{color:"#ADBAC7"}}," F["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    U2, S2, V2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.linalg.svd(F)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    S2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.diag(S2)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    S2["),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," U2 "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," S2 "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," V2")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," T2.T "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," F "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," T1")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," F")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," numpy "),s("span",{style:{color:"#D73A49"}},"as"),s("span",{style:{color:"#24292E"}}," np")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"normalize"),s("span",{style:{color:"#24292E"}},"(pt: np.ndarray):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Normalizes the given set of points."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    N "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," pt.shape["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    mean "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," pt "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," np.mean(pt, "),s("span",{style:{color:"#E36209"}},"axis"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    scale "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.sum(np.square(pt)) "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," ("),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," N)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    scale "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.sqrt("),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," scale)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," scale "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," mean, scale")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"compute_fundamental_mat"),s("span",{style:{color:"#24292E"}},"(pt1: np.ndarray, pt2: np.ndarray)-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Computes the fundamental matrix F using SVD."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    N "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," pt1.shape["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    norm_pt1, scale1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," normalize(pt1)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    norm_pt2, scale2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," normalize(pt2)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    T1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.array([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        [scale1, "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," scale1 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," np.mean(pt1[:, "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", scale1, "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," scale1 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," np.mean(pt1[:, "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    ])")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    T2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.array([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        [scale2, "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," scale2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," np.mean(pt2[:, "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", scale2, "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," scale2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," np.mean(pt2[:, "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"])],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    ])")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    A "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," []")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," i "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"range"),s("span",{style:{color:"#24292E"}},"(N):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        x1, y1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," norm_pt1[i]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        x2, y2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," norm_pt2[i]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        a "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.array([x2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," x1, x2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," y1, x2, y2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," x1, y2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," y1, y2, x1, y1, "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        A.append(a)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    A "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.array(A)  "),s("span",{style:{color:"#6A737D"}},"# (N, 9)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    U1, S1, V1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.linalg.svd(A)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," V1["),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},",:].reshape("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    F "),s("span",{style:{color:"#D73A49"}},"/="),s("span",{style:{color:"#24292E"}}," F["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    U2, S2, V2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.linalg.svd(F)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    S2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.diag(S2)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    S2["),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," U2 "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," S2 "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," V2")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," T2.T "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," F "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," T1")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," F")]),a(`
`),s("span",{class:"line"})])])],-1),A=l('<h3 id="ransac" tabindex="-1">RANSAC <a class="header-anchor" href="#ransac" aria-hidden="true">#</a></h3><p>Our feature detection and tracking algorithms are not perfect, leading to several erroneous correspondences (outliers). Therefore, RANSAC is used to remove these outliers.</p><p>RANSAC is an iterative algorithm terminating after a fixed number of iterations. At every iteration, it works in the following way:</p><ul><li>Picks 8 keypoint correspondences from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></li><li>Computes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> using Hartley’s 8-point algorithm mentioned above</li><li>Determines how many of all other keypoints are inliers</li></ul><p>Finally, the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> with the maximum number of inliers will be used.</p>',5),d=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"compute_ransac_error"),s("span",{style:{color:"#ADBAC7"}},"(F: np.ndarray, pt1: np.ndarray, pt2: np.ndarray):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    n "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," pt1.shape["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    p1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.hstack((pt1, np.ones((n, "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"))))")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    p2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.hstack((pt2, np.ones((n, "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"))))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    e1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," p1 "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," F.T")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    e2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," p2 "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," F")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    error "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.sum(e2 "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," p1, "),s("span",{style:{color:"#F69D50"}},"axis"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#F69D50"}},"keepdims"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"True"),s("span",{style:{color:"#ADBAC7"}},") "),s("span",{style:{color:"#F47067"}},"**"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," np.sum(np.hstack((e1[:, :"),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"], e2[:, :"),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"])) "),s("span",{style:{color:"#F47067"}},"**"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#F69D50"}},"axis"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#F69D50"}},"keepdims"),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#6CB6FF"}},"True"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," error")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"find_fundamental_mat"),s("span",{style:{color:"#ADBAC7"}},"(")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    pt1: np.ndarray, pt2: np.ndarray, threshold: "),s("span",{style:{color:"#6CB6FF"}},"float"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0.05")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},")-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Estimates the fundamental matrix using RANSAC."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    max_inliers "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    best_F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"None")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    confidence "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0.99")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    N "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," sys.maxsize")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    count "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"while"),s("span",{style:{color:"#ADBAC7"}}," N "),s("span",{style:{color:"#F47067"}},">"),s("span",{style:{color:"#ADBAC7"}}," count:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        x, y "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," sample_eight_points(pt1, pt2)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," compute_fundamental_mat(x, y)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        error "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," compute_ransac_error(F, pt1, pt2)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        inliers "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," error "),s("span",{style:{color:"#F47067"}},"<="),s("span",{style:{color:"#ADBAC7"}}," threshold")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        n_inliers "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.sum(inliers)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," max_inliers "),s("span",{style:{color:"#F47067"}},"<"),s("span",{style:{color:"#ADBAC7"}}," np.sum(inliers):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            max_inliers "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," n_inliers")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            best_F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," F.copy()")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ratio "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," n_inliers "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"len"),s("span",{style:{color:"#ADBAC7"}},"(pt1)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," np.log("),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," (ratio "),s("span",{style:{color:"#F47067"}},"**"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"8"),s("span",{style:{color:"#ADBAC7"}},")) "),s("span",{style:{color:"#F47067"}},"=="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            "),s("span",{style:{color:"#F47067"}},"continue")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        N "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.log("),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," confidence) "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," np.log("),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," (ratio "),s("span",{style:{color:"#F47067"}},"**"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"8"),s("span",{style:{color:"#ADBAC7"}},"))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        count "),s("span",{style:{color:"#F47067"}},"+="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"1")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," best_F")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"F "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," find_fundamental_mat(kp1, kp2, "),s("span",{style:{color:"#6CB6FF"}},"0.05"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"compute_ransac_error"),s("span",{style:{color:"#24292E"}},"(F: np.ndarray, pt1: np.ndarray, pt2: np.ndarray):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    n "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," pt1.shape["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    p1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.hstack((pt1, np.ones((n, "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"))))")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    p2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.hstack((pt2, np.ones((n, "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"))))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    e1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," p1 "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," F.T")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    e2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," p2 "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," F")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    error "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.sum(e2 "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," p1, "),s("span",{style:{color:"#E36209"}},"axis"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#E36209"}},"keepdims"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"True"),s("span",{style:{color:"#24292E"}},") "),s("span",{style:{color:"#D73A49"}},"**"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," np.sum(np.hstack((e1[:, :"),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"], e2[:, :"),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"])) "),s("span",{style:{color:"#D73A49"}},"**"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#E36209"}},"axis"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#E36209"}},"keepdims"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"True"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," error")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"find_fundamental_mat"),s("span",{style:{color:"#24292E"}},"(")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    pt1: np.ndarray, pt2: np.ndarray, threshold: "),s("span",{style:{color:"#005CC5"}},"float"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0.05")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},")-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Estimates the fundamental matrix using RANSAC."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    max_inliers "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    best_F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"None")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    confidence "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0.99")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    N "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," sys.maxsize")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    count "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"while"),s("span",{style:{color:"#24292E"}}," N "),s("span",{style:{color:"#D73A49"}},">"),s("span",{style:{color:"#24292E"}}," count:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        x, y "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," sample_eight_points(pt1, pt2)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," compute_fundamental_mat(x, y)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        error "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," compute_ransac_error(F, pt1, pt2)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        inliers "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," error "),s("span",{style:{color:"#D73A49"}},"<="),s("span",{style:{color:"#24292E"}}," threshold")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        n_inliers "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.sum(inliers)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," max_inliers "),s("span",{style:{color:"#D73A49"}},"<"),s("span",{style:{color:"#24292E"}}," np.sum(inliers):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            max_inliers "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," n_inliers")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            best_F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," F.copy()")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ratio "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," n_inliers "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"len"),s("span",{style:{color:"#24292E"}},"(pt1)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," np.log("),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," (ratio "),s("span",{style:{color:"#D73A49"}},"**"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"8"),s("span",{style:{color:"#24292E"}},")) "),s("span",{style:{color:"#D73A49"}},"=="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            "),s("span",{style:{color:"#D73A49"}},"continue")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        N "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.log("),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," confidence) "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," np.log("),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," (ratio "),s("span",{style:{color:"#D73A49"}},"**"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"8"),s("span",{style:{color:"#24292E"}},"))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        count "),s("span",{style:{color:"#D73A49"}},"+="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"1")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," best_F")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"F "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," find_fundamental_mat(kp1, kp2, "),s("span",{style:{color:"#005CC5"}},"0.05"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"})])])],-1),C=l('<p>Then the problem is how to pick 8 keypoint correspondences (<code>sample_eight_points</code>). While Hartley’s 8-point algorithm samples them randomly, to make the algorithm more robust to outliers, we can use the way mentioned <a href="https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-13-FundamentalMatrix.pdf" target="_blank" rel="noopener noreferrer">here</a> (page 39) instead: uniformly dividing a frame into an <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span> grid, then randomly selecting 8 grid cells and picking one pair of corresponding keypoints from each grid cell.</p><h2 id="essential-matrix" tabindex="-1">Essential Matrix <a class="header-anchor" href="#essential-matrix" aria-hidden="true">#</a></h2><p>Essential matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> is another <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> matrix. But unlike <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> assumes that the cameras obey the pinhole model. More specifically, given the camera calibration matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>, which also can be solved using SVD.</p>',3),D=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed has-highlighted-lines shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"find_essential_mat"),s("span",{style:{color:"#ADBAC7"}},"(K: np.ndarray, F: np.ndarray)-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Estimates the essential matrix."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    E "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," K.T "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," F "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," K")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    U, S, V "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.linalg.svd(E)")]),a(`
`),s("span",{class:"line highlighted"},[s("span",{style:{color:"#ADBAC7"}},"    S "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.asarray([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    ])")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line highlighted"},[s("span",{style:{color:"#ADBAC7"}},"    E "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," U "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," S "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," V")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    E "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," E "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," np.linalg.norm(E)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," E")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"E "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," find_essential_mat(K, F)")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light has-highlighted-lines shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"find_essential_mat"),s("span",{style:{color:"#24292E"}},"(K: np.ndarray, F: np.ndarray)-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Estimates the essential matrix."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    E "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," K.T "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," F "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," K")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    U, S, V "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.linalg.svd(E)")]),a(`
`),s("span",{class:"line highlighted"},[s("span",{style:{color:"#24292E"}},"    S "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.asarray([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    ])")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line highlighted"},[s("span",{style:{color:"#24292E"}},"    E "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," U "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," S "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," V")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    E "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," E "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," np.linalg.norm(E)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," E")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"E "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," find_essential_mat(K, F)")]),a(`
`),s("span",{class:"line"})])])],-1),v=l(`<p>Note that the singular values of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> are not necessarily <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> due to the noise in K. Thus <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> should be reconstructed with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> singular values:</p><p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span></span></p><hr><p>Now we have successfully estimated the essential matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> manually, looks cool! However, this can also be done with the help of OpenCV, and all you need is one line:</p>`,4),u=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"E, mask "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," cv2.findEssentialMat(kp2, kp1, K, cv2."),s("span",{style:{color:"#6CB6FF"}},"RANSAC"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0.999"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0.3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"None"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"E, mask "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," cv2.findEssentialMat(kp2, kp1, K, cv2."),s("span",{style:{color:"#005CC5"}},"RANSAC"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0.999"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0.3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"None"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"})])])],-1),B=l('<p>OpenCV uses <a href="https://www-users.cse.umn.edu/~hspark/CSci5980/nister.pdf" target="_blank" rel="noopener noreferrer">Nistér’s 5-point algorithm</a>, a more recent approach that is shown to give better results, to compute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>. It requires the minimum number of keypoints possible since <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> has only 5 degrees of freedom (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> has 7 degrees of freedom, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> has only 5 as it takes camera parameters into account).</p><h2 id="camera-pose" tabindex="-1">Camera Pose <a class="header-anchor" href="#camera-pose" aria-hidden="true">#</a></h2><p>Just follow <a href="https://cmsc426.github.io/sfm/#essential" target="_blank" rel="noopener noreferrer">here</a> to recover the camera rotation matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and translation vector <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>.</p>',3),F=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"linear_triangulation"),s("span",{style:{color:"#ADBAC7"}},"(")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    T1: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    R1: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    T2: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    R2: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    pt1: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    pt2: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    K: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},")-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Linear triangulation."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    P1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," K "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," np.hstack((R1, "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"R1 "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," T1))")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    P2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," K "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," np.hstack((R2, "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"R2 "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," T2))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    X "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," []")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," i "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"range"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#6CB6FF"}},"len"),s("span",{style:{color:"#ADBAC7"}},"(pt1)):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        x1, x2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," pt1[i], pt2[i]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        A1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," x1["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," P1["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},", :] "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," P1["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", :]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        A2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," x1["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," P1["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},", :] "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," P1["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", :]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        A3 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," x2["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," P2["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},", :] "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," P2["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", :]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        A4 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," x2["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"*"),s("span",{style:{color:"#ADBAC7"}}," P2["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},", :] "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}}," P2["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", :]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        A "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.asarray([A1, A2, A3, A4])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        U, S, V "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.linalg.svd(A)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        V "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," V["),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        V "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," V "),s("span",{style:{color:"#F47067"}},"/"),s("span",{style:{color:"#ADBAC7"}}," V["),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        X.append(V)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," np.asarray(X)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F47067"}},"def"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#DCBDFB"}},"recover_pose"),s("span",{style:{color:"#ADBAC7"}},"(E: np.ndarray, pt1, pt2, K: np.ndarray):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#96D0FF"}},'"""Recovers the camera pose."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    W "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.asarray([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},",  "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        ["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},",  "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    ])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    U, S, V "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.linalg.svd(E)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    poses "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"T1"'),s("span",{style:{color:"#ADBAC7"}},":  U[:, "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"].reshape("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"T2"'),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"U[:, "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"].reshape("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"T3"'),s("span",{style:{color:"#ADBAC7"}},":  U[:, "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"].reshape("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"T4"'),s("span",{style:{color:"#ADBAC7"}},": "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"U[:, "),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"].reshape("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"R1"'),s("span",{style:{color:"#ADBAC7"}},":  U "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," W   "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," V,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"R2"'),s("span",{style:{color:"#ADBAC7"}},":  U "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," W   "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," V,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"R3"'),s("span",{style:{color:"#ADBAC7"}},":  U "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," W.T "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," V,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#96D0FF"}},'"R4"'),s("span",{style:{color:"#ADBAC7"}},":  U "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," W.T "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," V")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    }")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," i "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"range"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"5"),s("span",{style:{color:"#ADBAC7"}},"):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        T, R "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," poses["),s("span",{style:{color:"#96D0FF"}},'"T"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)], poses["),s("span",{style:{color:"#96D0FF"}},'"R"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," np.linalg.det(R) "),s("span",{style:{color:"#F47067"}},"<"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            T "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"T")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            R "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"R")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            poses["),s("span",{style:{color:"#96D0FF"}},'"T"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)], poses["),s("span",{style:{color:"#96D0FF"}},'"R"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)] "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," T, R")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        I "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.identity("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        M "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.hstack((I, T.reshape("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},")))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        poses["),s("span",{style:{color:"#96D0FF"}},'"P"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)] "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," K "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," R "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," M")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    max_Z, rt_idx "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," i "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"range"),s("span",{style:{color:"#ADBAC7"}},"("),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"5"),s("span",{style:{color:"#ADBAC7"}},"):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        T1, R1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," poses["),s("span",{style:{color:"#96D0FF"}},'"T"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)], poses["),s("span",{style:{color:"#96D0FF"}},'"R"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#768390"}},"# ---------------------")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        T2, R2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.asarray([["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"],["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"],["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]]), np.identity("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        X "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," linear_triangulation(T2, R2, T1, R1, pt1, pt2, K)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        Z "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," j "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"range"),s("span",{style:{color:"#ADBAC7"}},"(X.shape["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},"]):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            x "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," X[j, :].reshape("),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," R1["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," np.subtract(x["),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},":"),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},"], T1) "),s("span",{style:{color:"#F47067"}},">"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"and"),s("span",{style:{color:"#ADBAC7"}}," x["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},">"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"                Z "),s("span",{style:{color:"#F47067"}},"+="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#768390"}},"# ---------------------")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," max_Z "),s("span",{style:{color:"#F47067"}},"<"),s("span",{style:{color:"#ADBAC7"}}," Z:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"            max_Z, rt_idx "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," Z, "),s("span",{style:{color:"#6CB6FF"}},"str"),s("span",{style:{color:"#ADBAC7"}},"(i)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    cur_T, cur_R "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," poses["),s("span",{style:{color:"#96D0FF"}},'"T"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," rt_idx], poses["),s("span",{style:{color:"#96D0FF"}},'"R"'),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," rt_idx]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," cur_T["),s("span",{style:{color:"#6CB6FF"}},"2"),s("span",{style:{color:"#ADBAC7"}},"] "),s("span",{style:{color:"#F47067"}},"<"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"0"),s("span",{style:{color:"#ADBAC7"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"        cur_T "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#F47067"}},"-"),s("span",{style:{color:"#ADBAC7"}},"cur_T")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"    "),s("span",{style:{color:"#F47067"}},"return"),s("span",{style:{color:"#ADBAC7"}}," cur_T, cur_R")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"cur_T, cur_R "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," recover_pose(E, kp1, kp2, K)")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"linear_triangulation"),s("span",{style:{color:"#24292E"}},"(")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    T1: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    R1: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    T2: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    R2: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    pt1: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    pt2: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    K: np.ndarray,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},")-> np.ndarray:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Linear triangulation."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    P1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," K "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," np.hstack((R1, "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"R1 "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," T1))")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    P2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," K "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," np.hstack((R2, "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"R2 "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," T2))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    X "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," []")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," i "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"range"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#005CC5"}},"len"),s("span",{style:{color:"#24292E"}},"(pt1)):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        x1, x2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," pt1[i], pt2[i]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        A1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," x1["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," P1["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},", :] "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," P1["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", :]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        A2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," x1["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," P1["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},", :] "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," P1["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", :]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        A3 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," x2["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," P2["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},", :] "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," P2["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", :]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        A4 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," x2["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," P2["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},", :] "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," P2["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", :]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        A "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.asarray([A1, A2, A3, A4])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        U, S, V "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.linalg.svd(A)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        V "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," V["),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        V "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," V "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," V["),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        X.append(V)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," np.asarray(X)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"recover_pose"),s("span",{style:{color:"#24292E"}},"(E: np.ndarray, pt1, pt2, K: np.ndarray):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},'"""Recovers the camera pose."""')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    W "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.asarray([")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},",  "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},",  "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    ])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    U, S, V "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.linalg.svd(E)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    poses "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"T1"'),s("span",{style:{color:"#24292E"}},":  U[:, "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"].reshape("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"T2"'),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"U[:, "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"].reshape("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"T3"'),s("span",{style:{color:"#24292E"}},":  U[:, "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"].reshape("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"T4"'),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"U[:, "),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"].reshape("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"),")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"R1"'),s("span",{style:{color:"#24292E"}},":  U "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," W   "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," V,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"R2"'),s("span",{style:{color:"#24292E"}},":  U "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," W   "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," V,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"R3"'),s("span",{style:{color:"#24292E"}},":  U "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," W.T "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," V,")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#032F62"}},'"R4"'),s("span",{style:{color:"#24292E"}},":  U "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," W.T "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," V")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    }")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," i "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"range"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"5"),s("span",{style:{color:"#24292E"}},"):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        T, R "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," poses["),s("span",{style:{color:"#032F62"}},'"T"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)], poses["),s("span",{style:{color:"#032F62"}},'"R"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," np.linalg.det(R) "),s("span",{style:{color:"#D73A49"}},"<"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            T "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"T")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            R "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"R")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            poses["),s("span",{style:{color:"#032F62"}},'"T"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)], poses["),s("span",{style:{color:"#032F62"}},'"R"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," T, R")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        I "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.identity("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        M "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.hstack((I, T.reshape("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},")))")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        poses["),s("span",{style:{color:"#032F62"}},'"P"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," K "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," R "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," M")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    max_Z, rt_idx "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," i "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"range"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"5"),s("span",{style:{color:"#24292E"}},"):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        T1, R1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," poses["),s("span",{style:{color:"#032F62"}},'"T"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)], poses["),s("span",{style:{color:"#032F62"}},'"R"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#6A737D"}},"# ---------------------")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        T2, R2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.asarray([["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"],["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"],["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]]), np.identity("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        X "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," linear_triangulation(T2, R2, T1, R1, pt1, pt2, K)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        Z "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," j "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"range"),s("span",{style:{color:"#24292E"}},"(X.shape["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]):")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            x "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," X[j, :].reshape("),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," R1["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," np.subtract(x["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},":"),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},"], T1) "),s("span",{style:{color:"#D73A49"}},">"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"and"),s("span",{style:{color:"#24292E"}}," x["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},">"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"                Z "),s("span",{style:{color:"#D73A49"}},"+="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#6A737D"}},"# ---------------------")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," max_Z "),s("span",{style:{color:"#D73A49"}},"<"),s("span",{style:{color:"#24292E"}}," Z:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            max_Z, rt_idx "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," Z, "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    cur_T, cur_R "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," poses["),s("span",{style:{color:"#032F62"}},'"T"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," rt_idx], poses["),s("span",{style:{color:"#032F62"}},'"R"'),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," rt_idx]")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," cur_T["),s("span",{style:{color:"#005CC5"}},"2"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"<"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        cur_T "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}},"cur_T")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," cur_T, cur_R")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"cur_T, cur_R "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," recover_pose(E, kp1, kp2, K)")]),a(`
`),s("span",{class:"line"})])])],-1),E=s("hr",null,null,-1),f=s("p",null,"Again, here is how to implement it in OpenCV:",-1),z=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"kp1 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.array([pt "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," (idx, pt) "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"enumerate"),s("span",{style:{color:"#ADBAC7"}},"(kp1) "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," mask[idx] "),s("span",{style:{color:"#F47067"}},"=="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"kp2 "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.array([pt "),s("span",{style:{color:"#F47067"}},"for"),s("span",{style:{color:"#ADBAC7"}}," (idx, pt) "),s("span",{style:{color:"#F47067"}},"in"),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"enumerate"),s("span",{style:{color:"#ADBAC7"}},"(kp2) "),s("span",{style:{color:"#F47067"}},"if"),s("span",{style:{color:"#ADBAC7"}}," mask[idx] "),s("span",{style:{color:"#F47067"}},"=="),s("span",{style:{color:"#ADBAC7"}}," "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"_, cur_R, cur_t, _ "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," cv2.recoverPose(E, kp2, kp1, K)")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"kp1 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.array([pt "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," (idx, pt) "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"enumerate"),s("span",{style:{color:"#24292E"}},"(kp1) "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," mask[idx] "),s("span",{style:{color:"#D73A49"}},"=="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"kp2 "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.array([pt "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," (idx, pt) "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"enumerate"),s("span",{style:{color:"#24292E"}},"(kp2) "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," mask[idx] "),s("span",{style:{color:"#D73A49"}},"=="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"])")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"_, cur_R, cur_t, _ "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," cv2.recoverPose(E, kp2, kp1, K)")]),a(`
`),s("span",{class:"line"})])])],-1),k=l('<h2 id="trajectory" tabindex="-1">Trajectory <a class="header-anchor" href="#trajectory" aria-hidden="true">#</a></h2><p>Denote the pose of the camera as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>, which should be initialized as:</p>',2),b=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"R, T "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," np.identity("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},"), np.zeros(("),s("span",{style:{color:"#6CB6FF"}},"3"),s("span",{style:{color:"#ADBAC7"}},", "),s("span",{style:{color:"#6CB6FF"}},"1"),s("span",{style:{color:"#ADBAC7"}},"))")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"R, T "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.identity("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},"), np.zeros(("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#005CC5"}},"1"),s("span",{style:{color:"#24292E"}},"))")]),a(`
`),s("span",{class:"line"})])])],-1),x=l('<p>We can update the trajectory of the camera by:</p><p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span></p>',3),_=s("div",{class:"language-python"},[s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark-dimmed shiki-dark"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"T "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," T "),s("span",{style:{color:"#F47067"}},"+"),s("span",{style:{color:"#ADBAC7"}}," R "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," cur_T")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#ADBAC7"}},"R "),s("span",{style:{color:"#F47067"}},"="),s("span",{style:{color:"#ADBAC7"}}," cur_R "),s("span",{style:{color:"#F47067"}},"@"),s("span",{style:{color:"#ADBAC7"}}," R")]),a(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki github-light shiki-light"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"T "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," T "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," R "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," cur_T")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"R "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," cur_R "),s("span",{style:{color:"#D73A49"}},"@"),s("span",{style:{color:"#24292E"}}," R")]),a(`
`),s("span",{class:"line"})])])],-1),w=l('<p>That’s it! We can now move to the next pair of frames <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and repeat from <a href="#feature-detection">here</a>.</p><p>Of course, there are many details and optimizations (e.g. bundle adjustment) that can be added to improve the accuracy and performance of the VO system, but this should give a good starting point for building a monocular VO system.</p><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-hidden="true">#</a></h2><ul><li><a href="https://cmsc426.github.io/sfm/" target="_blank" rel="noopener noreferrer">Structure from Motion (University of Maryland)</a></li><li><a href="https://www.cs.cmu.edu/~16385/s17/Slides/12.4_8Point_Algorithm.pdf" target="_blank" rel="noopener noreferrer">The 8-point algorithm (Carnegie Mellon University)</a></li><li><a href="https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-13-FundamentalMatrix.pdf" target="_blank" rel="noopener noreferrer">Fundamental Matrix (University of Central Florida)</a></li><li><a href="https://www-users.cse.umn.edu/~hspark/CSci5980/nister.pdf" target="_blank" rel="noopener noreferrer">An Efficient Solution to the Five-Point Relative Pose Problem</a>. <em>David Nistér</em>. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2004.</li><li><a href="https://avisingh599.github.io/vision/monocular-vo/" target="_blank" rel="noopener noreferrer">Monocular Visual Odometry using OpenCV</a></li></ul>',4),T=[c,i,y,m,h,g,A,d,C,D,v,u,B,F,E,f,z,k,b,x,_,w],N="Implement Monocular Visual Odometry",U=["computer vision"],I=[{property:"og:title",content:"Implement Monocular Visual Odometry"}],V={__name:"2022-12-19-monocular-visual-odometry",setup(R,{expose:n}){return n({frontmatter:{title:"Implement Monocular Visual Odometry",tags:["computer vision"],meta:[{property:"og:title",content:"Implement Monocular Visual Odometry"}]}}),t({title:"Implement Monocular Visual Odometry",meta:[{property:"og:title",content:"Implement Monocular Visual Odometry"}]}),(H,K)=>(e(),o("div",r,T))}},O=p(V,[["__file","/home/runner/work/renovamen.github.io/renovamen.github.io/pages/posts/2022-12-19-monocular-visual-odometry.md"]]);export{O as default,I as meta,U as tags,N as title};
