<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" href="/favicon.png" type="image/png"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="canonical" href="https://zxh.io/posts/zh/2019-04-03-racf-experiment/"><meta name="generator" content="Astro v4.0.8"><meta name="msapplication-TileColor" content="#ffffff"><title>RACF 实验 - Xiaohan Zou</title><!-- General Meta Tags --><meta name="title" content="RACF 实验 - Xiaohan Zou"><meta name="description" content="A dragon lost in human world."><meta name="author" content="Xiaohan Zou"><!-- Open Graph / Facebook --><meta property="og:title" content="RACF 实验 - Xiaohan Zou"><meta property="og:description" content="A dragon lost in human world."><meta property="og:url" content="https://zxh.io/posts/zh/2019-04-03-racf-experiment/"><!-- Twitter --><meta property="twitter:title" content="RACF 实验 - Xiaohan Zou"><meta property="twitter:description" content="A dragon lost in human world."><meta property="twitter:url" content="https://zxh.io/posts/zh/2019-04-03-racf-experiment/"><link rel="stylesheet" href="/_astro/index.lM4Plj1r.css" />
<link rel="stylesheet" href="/_astro/index.Ib3kOwLy.css" />
<style>.prev[data-astro-cid-gvpn4u4b] a[data-astro-cid-gvpn4u4b]:before{content:"← "}.next[data-astro-cid-gvpn4u4b] a[data-astro-cid-gvpn4u4b]:after{content:" →"}
</style><script type="module" src="/_astro/hoisted.232UYFQl.js"></script></head> <body class="font-sans"> <main class="post flex flex-col min-h-full text-c px-4 pt-24 pb-4 md:pb-6"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="19zquw" data-solid-render-id="s2" component-url="/_astro/Navbar.QUFNL5yP.js" component-export="default" renderer-url="/_astro/client.DKOYneLd.js" props="{&quot;activePage&quot;:[0,&quot;posts&quot;],&quot;hasToc&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Navbar&quot;,&quot;value&quot;:true}" await-children=""><header data-hk="s20-0" class="z-30 w-full h-14 hstack justify-between bg-c font-ui px-4 md:px-5 false false absolute top-0 left-0"><a font-bold text="c-light hover:c-dark" href="/"><span text-lg>hi@zxh</span><div i-fa6-solid:angle-right class="prompt inline-block"></div><span class="blink">_</span></a><nav hstack space-x-4><a nav-item href="/projects" title="Projects"><div i-ph:rocket-launch-duotone class="md:hidden"></div><span class="lt-md:hidden false">Projects</span></a><a nav-item href="/posts" title="Blog"><div i-majesticons:pencil-line class="md:hidden"></div><span class="lt-md:hidden active">Blog</span></a><a nav-item href="/search" title="Search"><span i-uil:search></span></a><button nav-item title="Toggle dark"><div i="carbon-sun dark:carbon-moon"></div></button><!--$--><button data-hk="s20-1-0" class="nav-item ml-4" title="Toggle toc"><div data-hk="s20-1-1" i-ri:menu-3-line></div></button><!--/--></nav></header><!--astro:end--></astro-island> <div class="flex-1 mb-6"> <div class="prose prose-lg mx-auto">  <div mt-6 mb-8 data-astro-cid-gvpn4u4b> <h1 text-4xl font-bold leading-12 my-0 data-astro-cid-gvpn4u4b>RACF 实验</h1> <p text-c-lighter mt-2 data-astro-cid-gvpn4u4b> Apr 3, 2019 · 16 min
 </p> </div> <div class="content mb-16" data-astro-cid-gvpn4u4b> <astro-island uid="ZhexrO" data-solid-render-id="s0" component-url="/_astro/TocButtons.ZyDlpHY1.js" component-export="default" renderer-url="/_astro/client.DKOYneLd.js" props="{&quot;prev&quot;:[0,&quot;zh/2019-02-15-rnn-with-its-friends&quot;],&quot;next&quot;:[0,&quot;zh/2019-07-06-last-three-years&quot;],&quot;data-astro-cid-gvpn4u4b&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;TocButtons&quot;,&quot;value&quot;:true}" await-children=""><div data-hk="s00-0" class="table-of-contents-btns fixed z-20"><div hstack justify-end pt-18 pb-2 bg-c><!--$--><span data-hk="s00-1" text="sm c-light" italic mr-3></span><!--/--><!--$--><a data-hk="s00-2" class="flex-center !text-c hover:opacity-60" href="/posts/zh/2019-02-15-rnn-with-its-friends"><span i-ic:round-keyboard-arrow-left text-xl></span></a><!--/--><!--$--><a data-hk="s00-3" href="/posts/zh/2019-07-06-last-three-years" class="flex-center !text-c hover:opacity-60"><span i-ic:round-keyboard-arrow-right text-xl></span></a><!--/--><button flex-center hover:opacity-60><span i-ic:round-keyboard-arrow-up text-xl></span></button><button class="flex-center hover:opacity-60 ml-1.5"><span i-mi:print text-sm></span></button></div></div><!--astro:end--></astro-island> <ul class="table-of-contents">
<li>
<p><a href="#_1-%E5%88%9B%E5%BB%BA%E7%BB%84">1. 创建组</a></p>
<ul>
<li><a href="#_11-%E7%BB%84%E7%9A%84%E7%BB%93%E6%9E%84">1.1 组的结构</a></li>
<li><a href="#_12-%E7%99%BB%E9%99%86-tso">1.2 登陆 TSO</a></li>
<li><a href="#_13-%E5%9C%A8-racflab-%E4%B8%8B%E5%AE%9A%E4%B9%89%E5%AD%90%E7%BB%84">1.3 在 RACFLAB 下定义子组</a></li>
<li><a href="#_14-%E5%9C%A8-div16fun-%E4%B8%8B%E5%AE%9A%E4%B9%89%E5%AD%90%E7%BB%84%E5%8A%9F%E8%83%BD%E7%BB%84">1.4 在 DIV16FUN 下定义子组（功能组）</a></li>
<li><a href="#_15-%E5%9C%A8-div16res-%E4%B8%8B%E5%AE%9A%E4%B9%89%E5%AD%90%E7%BB%84%E8%B5%84%E6%BA%90%E7%BB%84">1.5 在 DIV16RES 下定义子组（资源组）</a></li>
<li><a href="#_16-%E6%9F%A5%E6%89%BE%E7%BB%84-profile">1.6 查找组 Profile</a></li>
</ul>
</li>
<li>
<p><a href="#_2-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86">2. 用户管理</a></p>
<ul>
<li><a href="#_21-%E6%96%B0%E5%BB%BA%E7%94%A8%E6%88%B7">2.1 新建用户</a></li>
<li><a href="#_22-%E9%87%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81">2.2 重置用户密码</a></li>
<li><a href="#_23-revoke-%E7%94%A8%E6%88%B7">2.3 Revoke 用户</a></li>
<li><a href="#_24-resume-%E7%94%A8%E6%88%B7">2.4 Resume 用户</a></li>
<li><a href="#_25-search-%E6%9F%A5%E6%89%BE">2.5 Search 查找</a></li>
<li><a href="#_26-%E5%B0%86%E7%94%A8%E6%88%B7%E5%85%B3%E8%81%94%E5%88%B0%E7%BB%84">2.6 将用户关联到组</a></li>
<li><a href="#_27-%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E5%85%B3%E8%81%94%E5%88%B0%E7%BB%84">2.7 验证用户是否关联到组</a></li>
</ul>
</li>
<li>
<p><a href="#_3-%E5%88%86%E6%95%A3%E5%BC%8F-racf-%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86">3. 分散式 RACF 安全管理</a></p>
<ul>
<li><a href="#_31-%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E5%AE%9A%E4%BD%8D">3.1 用户身份定位</a></li>
<li><a href="#_32-%E6%B5%8B%E8%AF%95">3.2 测试</a></li>
</ul>
</li>
<li>
<p><a href="#_4-%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BF%9D%E6%8A%A4-i">4. 数据集保护 I</a></p>
<ul>
<li><a href="#_41-%E4%BF%9D%E6%8A%A4%E6%95%B0%E6%8D%AE%E9%9B%86">4.1 保护数据集</a></li>
<li><a href="#_42-%E6%9F%A5%E7%9C%8B-profile">4.2 查看 PROFILE</a></li>
<li><a href="#_43-%E5%AE%9A%E4%B9%89-rpofile--%E8%B5%8B-alter-%E6%9D%83">4.3 定义 RPOFILE + 赋 ALTER 权</a></li>
<li><a href="#_44-%E9%AA%8C%E8%AF%81">4.4 验证</a></li>
<li><a href="#_45-%E5%88%9B%E5%BB%BA%E7%BB%84%E6%95%B0%E6%8D%AE%E9%9B%86">4.5 创建组数据集</a></li>
<li><a href="#_46-%E9%AA%8C%E8%AF%81">4.6 验证</a></li>
</ul>
</li>
<li>
<p><a href="#_5-%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BF%9D%E6%8A%A4-ii">5. 数据集保护 II</a></p>
<ul>
<li><a href="#_51-%E5%88%9B%E5%BB%BA%E5%85%A8%E5%8C%B9%E9%85%8D-profile">5.1 创建全匹配 PROFILE</a></li>
<li><a href="#_52-%E6%89%93%E5%BC%80-warning-%E7%8A%B6%E6%80%81">5.2 打开 Warning 状态</a></li>
<li><a href="#_53-%E5%85%B3%E9%97%AD-warning-%E7%8A%B6%E6%80%81">5.3 关闭 Warning 状态</a></li>
<li><a href="#_54-update-%E6%9D%83%E9%99%90">5.4 UPDATE 权限</a></li>
</ul>
</li>
<li>
<p><a href="#_6-%E4%BF%9D%E6%8A%A4-tso-%E8%B5%84%E6%BA%90">6. 保护 TSO 资源</a></p>
<ul>
<li><a href="#_61-%E5%88%9B%E5%BB%BA%E7%BB%84%E7%BB%93%E6%9E%84">6.1 创建组结构</a></li>
<li><a href="#_62-%E6%96%B0%E5%A2%9E%E7%94%A8%E6%88%B7">6.2 新增用户</a></li>
<li><a href="#_63-%E5%88%9B%E5%BB%BA%E7%99%BB%E9%99%86%E8%BF%87%E7%A8%8B">6.3 创建登陆过程</a></li>
<li><a href="#_64-%E4%BF%9D%E6%8A%A4%E7%99%BB%E5%BD%95%E8%BF%87%E7%A8%8B">6.4 保护登录过程</a></li>
<li><a href="#_65-%E4%BF%9D%E6%8A%A4-acctnum">6.5 保护 ACCTNUM</a></li>
<li><a href="#_66-%E4%BF%9D%E6%8A%A4-tsoauth">6.6 保护 TSOAUTH</a></li>
<li><a href="#_67-%E4%BF%9D%E6%8A%A4%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E9%9B%86">6.7 保护用户数据集</a></li>
<li><a href="#_68-%E5%88%9B%E5%BB%BA-alias">6.8 创建 ALIAS</a></li>
</ul>
</li>
<li>
<p><a href="#_7-%E4%BD%BF%E7%94%A8-jcl-%E6%89%A7%E8%A1%8C-racf-%E5%91%BD%E4%BB%A4">7. 使用 JCL 执行 RACF 命令</a></p>
</li>
</ul>
<p>对我认为的本科最难的课（2333）第一次实验的流水账式记录。</p>
<p>希望早日脱离大型机的苦海，阿门。</p>
<h2 id="_1-创建组"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_1-创建组">#</a>1. 创建组</h2>
<h3 id="_11-组的结构"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_11-组的结构">#</a>1.1 组的结构</h3>
<p><img src="/img/posts/zh/2019-04-03/racf-2.1.png" alt=""></p>
<h3 id="_12-登陆-tso"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_12-登陆-tso">#</a>1.2 登陆 TSO</h3>
<p>以 RACFLAB 组管理员身份登陆 TSO：</p>
<ol>
<li>
<p>以 ST016 用户身份登录 TSO，进 ISPF；</p>
</li>
<li>
<p>“P” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span> “6”（或直接”P.6”）</p>
</li>
<li>
<p>使用 <code>LU</code> RACF 命令查看 ST016 的属性</p>
</li>
</ol>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LU ST016
</code></pre>
</div>
<h3 id="_13-在-racflab-下定义子组"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_13-在-racflab-下定义子组">#</a>1.3 在 RACFLAB 下定义子组</h3>
<p>利用 RACF 命令定义以下子组：</p>
<ul>
<li>
<p>定义 DIV16ADM 用户管理组（相当于公司人事部门），RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP DIV16ADM OWNER(RACFLAB) SUPGROUP(RACFLAB)
</code></pre>
</div>
</li>
<li>
<p>定义 DIV16FUN 功能组（相当于公司各职能部门），后继实验将在该组下定义各个子功能组，RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP DIV16FUN OWNER(RACFLAB) SUPGROUP(RACFLAB)
</code></pre>
</div>
</li>
<li>
<p>定义 DIV16RES 资源组（为有机组织和保护系统资源—包括数据集 / CICS 交易 / 系统和用户程序等资源—而设立的组），后继实验将在该组下定义各个子资源组，RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP DIV16RES OWNER(RACFLAB) SUPGROUP(RACFLAB)
</code></pre>
</div>
</li>
</ul>
<p>利用 RACF 命令查看新建的组进行验证：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LG DIV16ADM
LG DIV16FUN
LG DIV16RES
</code></pre>
</div>
<h3 id="_14-在-div16fun-下定义子组功能组"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_14-在-div16fun-下定义子组功能组">#</a>1.4 在 DIV16FUN 下定义子组（功能组）</h3>
<p>利用 RACF 命令定义以下子组：</p>
<ul>
<li>
<p>定义 FUN16PRD 功能组，该组将用于对生产系统数据集（Production Data Sets）的访问进行集中授权（即如果该组对生产系统数据集有访问权限，该组的成员将自动继承这一权限），RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP FUN16PRD OWNER(DIV16FUN) SUPGROUP(DIV16FUN)
</code></pre>
</div>
</li>
<li>
<p>定义 FUN16TST 功能组，该组将用于对测试系统数据集（Test Data Sets）的访问进行集中授权（即如果该组对测试系统数据集有访问权限，该组的成员将自动继承这一权限），RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP FUN16TST OWNER(DIV16FUN) SUPGROUP(DIV16FUN)
</code></pre>
</div>
</li>
</ul>
<h3 id="_15-在-div16res-下定义子组资源组"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_15-在-div16res-下定义子组资源组">#</a>1.5 在 DIV16RES 下定义子组（资源组）</h3>
<p>利用 RACF 命令定义以下子组（RACF 中数据集 Profile 的 HLQ 必须是 RACF 系统中的一个用户或者组，这里为即将要保护的数据集 RES16PRD.* 和 RES16TST 定义 2 个子组）：</p>
<ul>
<li>
<p>定义 RES16PRD 资源组，该组将用于保护生产系统的数据集。RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP RES16PRD OWNER(DIV16RES) SUPGROUP(DIV16RES)
</code></pre>
</div>
</li>
<li>
<p>定义 RES16TST 资源组，该组将用于保护测试系统的数据集。RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP RES16TST OWNER(DIV16RES) SUPGROUP(DIV16RES)
</code></pre>
</div>
</li>
</ul>
<h3 id="_16-查找组-profile"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_16-查找组-profile">#</a>1.6 查找组 Profile</h3>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>SEARCH CLASS(GROUP) MASK(DIV16)
</code></pre>
</div>
<p> </p>
<h2 id="_2-用户管理"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_2-用户管理">#</a>2. 用户管理</h2>
<p><img src="/img/posts/zh/2019-04-03/racf-3.1.png" alt=""></p>
<h3 id="_21-新建用户"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_21-新建用户">#</a>2.1 新建用户</h3>
<ol>
<li>
<p>在不太了解用户需要什么权限的情况下，一般只给出最低权限，利用 RACF 命令完成以下设置：</p>
<ol>
<li>指定用户的默认组为 DIV16ADM</li>
<li>为用户指定初始密码</li>
<li>考虑为用户指定 OWNER</li>
<li>新增以下用户:
<ol>
<li>TSO1601 for user Janet Smith</li>
<li>TSO1602 for user Robert Anderson</li>
<li>TSO1603 for user Leslie Brown</li>
<li>TSO1604 for user Arthur Fielding</li>
<li>TSO1605 for user Susan Johnson</li>
</ol>
</li>
</ol>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDUSER TSO1601 OWNER(DIV16ADM) DFLTGRP(DIV16ADM) PASSWORD(PASS)
# 以此类推
</code></pre>
</div>
</li>
<li>
<p>查看用户是否建立成功</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LU TSO1601
</code></pre>
</div>
<p>查看用户的 TSO 段是否有内容</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LU TSO1601 TSO
</code></pre>
</div>
</li>
<li>
<p>如果用户 Profile 没有指定 TSO 段的内容，用户将无法顺利登陆 TSO 系统，需要为用户指定 TSO 段信息</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALU TSO1601 TSO(PROC(IKJDB2) ACCTNUM(#ACCT) SIZE(4096))
</code></pre>
</div>
</li>
<li>
<p>用户登陆 TSO 之后，如果要进入 ISPF 面板系统，首次进入 ISPF 系统时系统会自动为用户建立几个编目的数据集，通常普通用户的文件无法在主机系统主目录（Master Catalog）中进行编目，所以，要实现为新用户创建好用户目录（User Catalog）和别名（Alias）。</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>DEFINE ALIAS(NAME(TSO1601) RELATE('CATALOG.UCAT.STGRP'))
</code></pre>
</div>
<p>在 OPTION3.4 中 DSN Level 输入 TSO1601 回车，看是否显示其 “ALIAS”，如果出现类似下面的结果则表明 ALIAS 创建成功：</p>
<p></p><div class="language-bash"><span class="lang">bash</span><p></p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display: grid;"><span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DSLIST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Sets</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Matching</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TSO1601</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       Row</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        Volume</span></span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---------------------------------------------------------------------</span></span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TSO1601</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                                                 *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ALIAS</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> End of Data Set list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***********************</span></span></code></pre></figure>
</div>
</li>
</ol>
<h3 id="_22-重置用户密码"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_22-重置用户密码">#</a>2.2 重置用户密码</h3>
<p>当用户忘记密码的时后需要管理员 ST016 为该用户重新指定一个初始密码。</p>
<p>场景：Janet Smith（TSO1601）遗忘了密码：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALU TSO1601 PASSWORD(PASS)
</code></pre>
</div>
<h3 id="_23-revoke-用户"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_23-revoke-用户">#</a>2.3 Revoke 用户</h3>
<p>当用户帐号暂时不用的时候，安全起见应该将该帐号挂起（Revoke）。
场景：Arthur Fielding（TSO1604）将会出差一段时间，在这段时间应将该用户的帐号挂起：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALU TSO1601 REVOKE
</code></pre>
</div>
<h3 id="_24-resume-用户"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_24-resume-用户">#</a>2.4 Resume 用户</h3>
<p>当挂起的用户帐号需要重新启用的时候，应该及时地将帐号 Resume。
场景：Arthur Fielding（TSO1604）出差回来，希望能够继续使用以前的帐号：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALU TSO1601 RESUME
</code></pre>
</div>
<h3 id="_25-search-查找"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_25-search-查找">#</a>2.5 Search 查找</h3>
<p>使用 Search 命令查找以上新建的用户 Profile</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>SEARCH CLASS(USER) MASK(TSO1601)
</code></pre>
</div>
<h3 id="_26-将用户关联到组"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_26-将用户关联到组">#</a>2.6 将用户关联到组</h3>
<p>RACF 中给用户访问资源权限的最佳方法是将用户关联到可以访问这些资源的组中，这些组称为功能组（Functional Group）。</p>
<ul>
<li>
<p>将用户 Arthur Fielding（TSO1604）连接到组 FUN16PRD，实现其对生产数据集的访问：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>CONNECT TSO1604 GROUP(FUN16PRD)
</code></pre>
</div>
</li>
<li>
<p>将用户 Susan Johnson（TSOxx05）连接到组 FUN16TST，实现其对测试数据集的访问：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>CONNECT TSO1605 GROUP(FUN16TST)
</code></pre>
</div>
</li>
</ul>
<h3 id="_27-验证用户是否关联到组"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_27-验证用户是否关联到组">#</a>2.7 验证用户是否关联到组</h3>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LU TSO1604
LU TSO1605
LG FUN16PRD
LG FUN16TST
</code></pre>
</div>
<p> </p>
<h2 id="_3-分散式-racf-安全管理"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_3-分散式-racf-安全管理">#</a>3. 分散式 RACF 安全管理</h2>
<p><strong>目的</strong>：实现 RACF 中的管理权限下放（Delegation）</p>
<p><strong>内容</strong>：新建几个管理员用户，其中一个管理员负责用户安全的管理，一个管理员负 责将用户连接到功能组，另外一个管理员管控制对数据集资源的访问：</p>





















<table><thead><tr><th>USER</th><th>AUTHORITY</th></tr></thead><tbody><tr><td>TSO1601</td><td>group special for DIV16ADM</td></tr><tr><td>TSO1602</td><td>connect authority for FUN16PRD &#x26; FUN16TST</td></tr><tr><td>TSO1603</td><td>create authority for RES16PRD &#x26; RES16TST</td></tr></tbody></table>
<p><img src="/img/posts/zh/2019-04-03/racf-4.1.png" alt=""></p>
<h3 id="_31-用户身份定位"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_31-用户身份定位">#</a>3.1 用户身份定位</h3>
<ul>
<li>
<p>TSO1601（Janet Smith）：该管理员将对 DIV16ADM 组用户的安全进行管理，包括为用户重置密码，挂起和启用用户：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>CONNECT TSO1601 GROUP(DIV16ADM) SPECIAL
</code></pre>
</div>
</li>
<li>
<p>TSO1602（Robert Anderson）：该管理员可以将用户关联到 DIV16FUN 组下的子功能组中，以实现用户对特定数据的访问权限：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>CONNECT TSO1602 GROUP(FUN16PRD) AUTHORITY(CONNECT)
CONNECT TSO1602 GROUP(FUN16TST) AUTHORITY(CONNECT)
</code></pre>
</div>
</li>
<li>
<p>TSO1603（Leslie Brown）：该管理员可以为 RES16PRD 和 RES16TST 组数据集创建数据集 PROFILE，以控制用户对组数据集的访问：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>CONNECT TSO1603 GROUP(RES16PRD) AUTHORITY(CREATE)
CONNECT TSO1603 GROUP(RES16TST) AUTHORITY(CREATE)
</code></pre>
</div>
</li>
</ul>
<h3 id="_32-测试"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_32-测试">#</a>3.2 测试</h3>
<p>测试步骤 1 的功能是否实现：</p>
<ol>
<li>
<p>以 TSO1601 身份登陆 TSO，尝试修改用户密码等</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALU TSO1602 PASSWORD(PASS)
</code></pre>
</div>
</li>
<li>
<p>以 TSO1602 身份登陆 TSO，将 TSO1601 用户关联到 FUN16PRD 和 FUN16TST：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>CONNECT TSO1601 GROUP(FUN16PRD)
CONNECT TSO1601 GROUP(FUN16TST)
</code></pre>
</div>
</li>
<li>
<p>以 TSOxx02 身份登陆 TSO，将 TSO1601 从 FUN16PRD 和 FUN16TST 组中移走：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>REMOVE TSO1601 GROUP(FUN16PRD)
REMOVE TSO1601 GROUP(FUN16TST)
</code></pre>
</div>
</li>
</ol>
<p> </p>
<h2 id="_4-数据集保护-i"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_4-数据集保护-i">#</a>4. 数据集保护 I</h2>
<p><strong>目的</strong>：实现对用户数据集和组数据集的保护。</p>
<p><strong>内容</strong>：首先保护用户数据集，然后对生产数据集和测试数据集进行保护，然后进行授权后的验证。</p>
<p>为了简化实验，RES16PRD 和 RES16TST 组既是 Data Control Group，也是 Resource Onwership Group。</p>
<h3 id="_41-保护数据集"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_41-保护数据集">#</a>4.1 保护数据集</h3>
<p>保护以下用户的数据集，保护准则：只有用户本身可以访问自己的数据集，其他人都不能访问。（用户的数据集是指以用户名为 HLQ 的所有数据集）</p>
<ul>
<li>
<p>TSO1601 for user Janet Smith</p>
</li>
<li>
<p>TSO1602 for user Robert Anderson</p>
</li>
<li>
<p>TSO1603 for user Leslie Brown</p>
</li>
<li>
<p>TSO1604 for user Arthur Fielding</p>
</li>
<li>
<p>TSO1605 for user Susan Johnson</p>
</li>
</ul>
<p>以 TSO1601 身份登陆 TSO 然后执行 RACF 命令：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'TSO1601.**' UACC(NONE)
ADDSD 'TSO1602.**' UACC(NONE)
ADDSD 'TSO1603.**' UACC(NONE)
ADDSD 'TSO1604.**' UACC(NONE)
ADDSD 'TSO1605.**' UACC(NONE)
</code></pre>
</div>
<h3 id="_42-查看-profile"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_42-查看-profile">#</a>4.2 查看 PROFILE</h3>
<p>查看步骤 1 创建的用户数据集 PROFILE：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LISTDSD DA('TSO1601.**') ALL
LISTDSD DA('TSO1602.**') ALL
LISTDSD DA('TSO1603.**') ALL
LISTDSD DA('TSO1604.**') ALL
LISTDSD DA('TSO1605.**') ALL
</code></pre>
</div>
<h3 id="_43-定义-rpofile--赋-alter-权"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_43-定义-rpofile--赋-alter-权">#</a>4.3 定义 RPOFILE + 赋 ALTER 权</h3>
<p>定义 RES16TST 组数据集的 RPOFILE。在前面的实验中，TSO1603 被指定为 RES16PRD 和 RES16TST 的 Create 用户，以拥有对这 2 个组的数据集的保护权限。</p>
<ol>
<li>
<p>以 TSO1603 登陆 TSO，对 RES16TST 数据集进行以下保护：</p>
<ul>
<li>
<p>Audit all unsuccessful accesses (Hint: AUDIT)</p>
</li>
<li>
<p>Make the owner TSO1603 (Hint: OWNER)</p>
</li>
<li>
<p>No other users or groups should have access (Hint: UACC)</p>
</li>
</ul>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'RES16TST.**' AUDIT(FAILURES) OWNER(TSO1603) UACC(NONE)
</code></pre>
</div>
<p>修改上面定义的 <code>RES16TST.**</code> PORFILE 的访问列表，给 FUN16TST 组赋予 ALTER 访问权限：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>PERMIT 'RES16TST.**' ID(FUN16TST) ACCESS(ALTER)
</code></pre>
</div>
</li>
<li>
<p>对 RES16PRD 数据集进行以下保护：</p>
<ul>
<li>
<p>Audit all unsuccessful accesses (AUDIT)</p>
</li>
<li>
<p>Audit successful accesses at UPDATE and higher (AUDIT)</p>
</li>
<li>
<p>Make the owner TSO1603 (OWNER)</p>
</li>
<li>
<p>No other users or groups should have access (UACC)</p>
</li>
</ul>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'RES16PRD.**' AUDIT(FAILURES SUCCESS(UPDATE)) OWNER(TSO1603) UACC(NONE)
</code></pre>
</div>
<p>修改上面定义的 <code>RESxxPRD.**</code> PORFILE 的访问列表，给 FUN16PRD 组赋予 ALTER 访问权限：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>PERMIT 'RES16PRD.**' ID(FUN16PRD) ACCESS(ALTER)
</code></pre>
</div>
</li>
</ol>
<h3 id="_44-验证"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_44-验证">#</a>4.4 验证</h3>
<p>确定组数据集 PROFIEL 是否创建并按照预定的要求保护成功</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LISTDSD DATASET('RES16TST.**') ALL
LISTDSD DATASET('RES16PRD.**') ALL
</code></pre>
</div>
<h3 id="_45-创建组数据集"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_45-创建组数据集">#</a>4.5 创建组数据集</h3>
<p>以 ST016 用户登陆 TSO，创建 RES16TST 和 RES16PRD 组数据集：</p>
<ol>
<li>
<p>创建 ALIAS：RES16TST 和 RES16PRD</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>DEFINE ALIAS(NAME(RES16TST) RELATE(CATALOG.UCAT.STGRP))
DEFINE ALIAS(NAME(RES16PRD) RELATE(CATALOG.UCAT.STGRP))
</code></pre>
</div>
</li>
<li>
<p>测试是否成功</p>
<p>在 OPTION 3.4 中 DSN Level 分别输入 RES16TST**、**RES16PRD，回车，看是否显示其 Alias。</p>
</li>
</ol>
<p>以 TSO1603 登陆 TSO 并创建组数据集：</p>
<p>创建一个顺序数据集 RES16PRD.DATA (RECFM=FB, LRECL=80) 和 RES16TST.DATA (RECFM=FB, LRECL=80)</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>                        Allocate New Data Set
Data Set Name  . . . : RESxxPRD.DATA
Management class . . .       (Blank for default management class)
Storage class  . . . .       (Blank for default storage class)
 Volume serial . . . .       (Blank for system default volume) **
 Device type . . . . .       (Generic unit or device address) **
Data class . . . . . .       (Blank for default data class)
 Space units . . . . . TRKS  (BLKS, TRKS, CYLS, KB, MB, BYTES or RECORDS)
 Average record unit         (M, K, or U)
 Primary quantity  . . 1     (In above units)
 Secondary quantity    1     (In above units)
 Directory blocks  . .       (Zero for sequential data set) *
 Record format . . . . FB
 Record length . . . . 80
 Blocksize   . . . . .
 Data set name type :        (LIBRARY, HFS, PDS, or blank)  *
                             (YY/MM/DD, YYYY/MM/DD
 Expiration date . . .        YY.DDD, YYYY.DDD in Julian form
Enter "/" to select option    DDDD for retention period in days
   Allocate Multiple Volumes  or blank)

( * Specifying LIBRARY may override zero directory block)

( ** Only one of these fields may be specified)
</code></pre>
</div>
<h3 id="_46-验证"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_46-验证">#</a>4.6 验证</h3>
<ul>
<li>
<p>验证 TSO1604 访问 RES16PRD 组数据集：成功访问；</p>
</li>
<li>
<p>验证 TSO1604 访问 RES16TST 组数据集：拒绝访问；</p>
</li>
<li>
<p>验证 TSO1605 访问 RES16TST 组数据集的保护：成功访问。</p>
</li>
<li>
<p>以 TSO1601 登陆，删除 RES16PRD 打头的数据集（如 <code>RES16PRD.DATA</code>）</p>
<p>保留 TSO1601 登陆的 Session，再打开一个新的 Session，以 TSO1603 登陆 TSO，修改 <code>RESxxPRD.**</code> Profile，给 TSO1601 赋 ALTER 权：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>PERMIT 'RES16PRD.**' ID(TSO1601) ACCESS(ALTER)
</code></pre>
</div>
<p>测试：</p>
<ul>
<li>再尝试用 TSO1601 用户删除 <code>RES16PRD.DATA</code></li>
<li>TSO1601 重新登陆后再尝试删除 <code>RES16PRD.DATA</code></li>
</ul>
</li>
</ul>
<p> </p>
<h2 id="_5-数据集保护-ii"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_5-数据集保护-ii">#</a>5. 数据集保护 II</h2>
<p>目的：实现对用户数据集和组数据集的保护</p>
<p>内容：创建数据集，确定创建数据集需要的权限，然后建立 Generic PROFILE 对数据集进行保护，最后对 PROFILE 的 Warning 状态进行理解和配置，并使用 LISTDSD 命令确定最佳匹配 PROFILE 和确定 Generic PROFILE 所保护的数据集范围。</p>
<h3 id="_51-创建全匹配-profile"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_51-创建全匹配-profile">#</a>5.1 创建全匹配 PROFILE</h3>
<p>为 RES16PRD.DATA 创建全匹配 PROFILE。以 TSO1603 登陆（RES16PRD 组 CREATE 特权人员，即数据管理人员），为 <code>RES16PRD.DATA</code> 创建一个全匹配的 PROFILE 进行保护：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'RES16PRD.DATA' UACC(READ)
</code></pre>
</div>
<h3 id="_52-打开-warning-状态"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_52-打开-warning-状态">#</a>5.2 打开 Warning 状态</h3>
<p>以 TSO1603 登陆，把 <code>RES16TST.**</code> PROFILE 的 Warning 状态打开：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALTDSD 'RES16TST.**' WARNING
</code></pre>
</div>
<p>测试：以 TSO1604 登陆，浏览 <code>RES16TST.DATA</code> 数据集</p>
<h3 id="_53-关闭-warning-状态"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_53-关闭-warning-状态">#</a>5.3 关闭 Warning 状态</h3>
<p>以 TSO1603 登陆，把 <code>RES16TST.**</code> PROFILE 的 Warning 状态关闭：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ALTDSD 'RES16TST.**' NOWARNING
</code></pre>
</div>
<p>测试：以 TSO1604 登陆，浏览 <code>RES16TST.DATA</code> 数据集</p>
<h3 id="_54-update-权限"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_54-update-权限">#</a>5.4 UPDATE 权限</h3>
<p>TSO1603 登陆。假设 <code>RES16PRD.NEWAPPL.FINANCE.DATA</code> 和 <code>RES16PRD.NEWAPPL.HR.DATA</code> 是一个新应用系统的 2 个数据集，FUN16TST 组需要对这 2 个数据集有 UPDATE 权限，而不能对其他应用系统的数据集有操作权限。注意，FUN16PRD 组仍然需要对所有的 RES16PRD 数据集保留原有的操作权限。</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'RES16PRD.NEWAPPL.**' UACC(NONE) FROM('RES16PRD.**')
PERMIT 'RES16PRD.NEWAPPL.**' ID(FUN16TST) ACC(UPDATE)
</code></pre>
</div>
<p>检测哪一个 PROFILE 在保护 <code>RES16PRD.NEWAPPL.FINANCE.DATA</code> 和 <code>RES16PRD.NEWAPPL.HR.DATA</code>：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LISTDSD DATASET('RES16PRD.NEWAPPL.FINANCE.DATA') GEN
LISTDSD DATASET('RES16PRD.NEWAPPL.HR.DATA') GEN
</code></pre>
</div>
<p>检测一个 Generic PROFILE <code>RES16PRD.**</code> 保护了那些数据集：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>LISTDSD DATASET('RES16PRD.**') DSNS
</code></pre>
</div>
<p> </p>
<h2 id="_6-保护-tso-资源"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_6-保护-tso-资源">#</a>6. 保护 TSO 资源</h2>
<p>目的：授权用户登录 TSO</p>
<p>内容：该实验将首先为 AP（Application Programmer）和 SP（System Programmer）用户建立组结构，然后为 TSO 的登陆过程（TSOPROC）和用户帐号（ACCTNUM 建立一些通用资源 PROFILE 进行保护，接着新增 AP/SP 用户 PROFILE，对 TSO 段进行赋值，并对他们授权访问 TSO。</p>
<p>组结构：</p>
<p><img src="/img/posts/zh/2019-04-03/racf-7.1.png" alt=""></p>
<h3 id="_61-创建组结构"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_61-创建组结构">#</a>6.1 创建组结构</h3>
<ol>
<li>
<p>在 DIV16FUN 下创建子组 FUN16AP</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP FUN16AP OWNER(DIV16FUN) SUPGROUP(DIV16FUN)
</code></pre>
</div>
</li>
<li>
<p>在 DIV16FUN 下创建子组 FUN16SP</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP FUN16SP OWNER(DIV16FUN) SUPGROUP(DIV16FUN)
</code></pre>
</div>
</li>
<li>
<p>在 DIV16RES 下创建子组 RES16TSO，用以管理 TSO 资源授权</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDGROUP RES16TSO OWNER(DIV16RES) SUPGROUP(DIV16RES)
</code></pre>
</div>
</li>
</ol>
<h3 id="_62-新增用户"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_62-新增用户">#</a>6.2 新增用户</h3>
<p>新增 AP 和 SP 用户，这些用户需要访问 TSO</p>
<ol>
<li>
<p>新增 SP 用户 TSO1607，要求如下:</p>
<ul>
<li>
<p>OWNER 和默认组应该是 DIV16ADM</p>
</li>
<li>
<p>可以登陆 TSO</p>
<ol>
<li>账户使用 ACCT#Sxx</li>
<li>登陆过程使用 PROC#Sxx</li>
<li>Region 大小为 4096</li>
</ol>
</li>
</ul>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDUSER TSO1607 OWNER(DIV16ADM) NAME('SYSTEM PROGRAMMER') DFLTGRP(DIV16ADM) PASSWORD(123456)

ALU TSO1607 TSO(PROC(IKJDB2) ACCTNUM(#ACCT) SIZE(4096) COMMAN(ISPF))

CONNECT TSO1607 GROUP(FUN16SP)
</code></pre>
</div>
</li>
<li>
<p>新增 AP 用户 TSO1608，要求如下:</p>
<ul>
<li>
<p>OWNER 和默认组应该是 DIV16ADM</p>
</li>
<li>
<p>可以登陆 TSO</p>
<ol>
<li>账户使用 ACCT#Axx</li>
<li>登陆过程使用 PROC#Axx</li>
<li>Region 大小为 4096</li>
</ol>
</li>
</ul>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDUSER TSO1608 OWNER(DIV16ADM) NAME('SYSTEM PROGRAMMER') DFLTGRP(DIV16ADM) PASSWORD(123456)

ALU TSO1608 TSO(PROC(IKJDB2) ACCTNUM(#ACCT) SIZE(4096) COMMAN(ISPF))

CONNECT TSO1608 GROUP(FUN16AP)
</code></pre>
</div>
</li>
</ol>
<h3 id="_63-创建登陆过程"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_63-创建登陆过程">#</a>6.3 创建登陆过程</h3>
<p>为 TSO 用户创建一个新的登陆过程 PROC#Sxx 和 PROC#Axx。打开文件 VENDOR.PROCLIB ，在 Command 中输入：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>S PROC#S16;COPY IKJDB2
S PROC#A16;COPY IKJDB2
</code></pre>
</div>
<h3 id="_64-保护登录过程"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_64-保护登录过程">#</a>6.4 保护登录过程</h3>
<p>保护 PROC#Sxx 登陆过程（TSOPROC 类）。</p>
<ol>
<li>
<p>创建通用资源 TSOPROC 的 RPOFILE，保护 AP 和 SP 的 TSO 登陆过程。</p>
<p>授权规则：PROC#Sxx 只有 SP 才能使用（READ 权限），其他人不可以使用；PROC#Axx 只有 AP 才能使用（READ 权限），其他人不可以使用。</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>RDEFINE TSOPROC PROC#S16 OWNER(DIV16FUN) UACC(NONE)
PE PROC#S16 CLASS(TSOPROC) ID(FUN16SP) AC(READ)

RDEFINE TSOPROC PROC#A16 OWNER(DIV16FUN) UACC(NONE)
PE PROC#A16 CLASS(TSOPROC) ID(FUN16AP) AC(READ)
</code></pre>
</div>
</li>
<li>
<p>浏览 PROC#Sxx 和 PROC#Axx PROFILE，它们用于保护不同的 TSO 登陆服务：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>RLIST TSOPROC PROC#S16 AUTHUSER
RLIST TSOPROC PROC#A16 AUTHUSER
</code></pre>
</div>
</li>
<li>
<p>刷新 TSOPROC 类在内存中的 PROFILE</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>SETROPTS RACLIST(TSOPROC) REFRESH
</code></pre>
</div>
<p>可能会提示不需要刷新。</p>
</li>
</ol>
<h3 id="_65-保护-acctnum"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_65-保护-acctnum">#</a>6.5 保护 ACCTNUM</h3>
<p>创建两个 TSO 账户（ACCTNUM），并创建一个通用资源 RPOFILE 保护该 ACCTNUM。</p>
<ol>
<li>
<p>创建 RPOFILE：ACCT#Sxx 该 ACCTNUM 为 SP 提供 TSO 登陆服务。</p>
<p>授权规则：ACCT#Sxx 只有 SP 才能使用(READ 权限)，其他人不可以使用。</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>RDEFINE ACCTNUM ACCT#S16 OWNER(DIV16FUN) UACC(NONE)
PE ACCT#S16 CLASS(ACCTNUM) ID(FUN16SP) AC(READ)
</code></pre>
</div>
</li>
<li>
<p>创建 PROFILE：ACCT#Axx 该 ACCTNUM 为 AP 提供 TSO 登陆服务。</p>
<p>授权规则：ACCT#Axx 只有 AP 才能使用(READ 权限)，其他人不可以使用。</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>RDEFINE ACCTNUM ACCT#A16 OWNER(DIV16FUN) UACC(NONE)
PE ACCT#A16 CLASS(ACCTNUM) ID(FUN16AP) AC(READ)
</code></pre>
</div>
</li>
<li>
<p>浏览 PROFILE：ACCT#Sxx 和 ACCT#Axx</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>RLIST ACCTNUM ACCT#S16 AUTHUSER
RLIST ACCTNUM ACCT#A16 AUTHUSER
</code></pre>
</div>
</li>
</ol>
<h3 id="_66-保护-tsoauth"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_66-保护-tsoauth">#</a>6.6 保护 TSOAUTH</h3>
<p>TSOAUTH 通用资源类提供保护 TSO 权限的功能，TSO 权限主要包括：ACCT，JCL，MOUNT， OPER，RECOVER 等。系统已经定义了一个 JCL PROFILE 用于保护 TSO 的 JCL 权限，该权限允许通过 TSO 向 JES 提交 JCL 批量作业。</p>
<ol>
<li>
<p>（不做）为 SP 和 AP 用户赋权访问 JCL 权限：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>PE JCL CLASS(TSOAUTH) ID(FUN16AP FUN16SP) ACCESS(READ)
</code></pre>
</div>
</li>
<li>
<p>查看 SP 和 AP 用户是否拥有提交 JCL 作业的权利：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>RLIST TSOAUTH JCL
</code></pre>
</div>
</li>
</ol>
<h3 id="_67-保护用户数据集"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_67-保护用户数据集">#</a>6.7 保护用户数据集</h3>
<ol>
<li>
<p>保护 TSO1607 的用户数据集</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'TSO1607.**' UACC(NONE)
</code></pre>
</div>
</li>
<li>
<p>保护 TSO1608 的用户数据集</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>ADDSD 'TSO1608.**' UACC(NONE)
</code></pre>
</div>
</li>
</ol>
<h3 id="_68-创建-alias"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_68-创建-alias">#</a>6.8 创建 ALIAS</h3>
<p>为 TSOxx07 和 TSOxx08 创建 ALIAS（普通用户不能修改 Master Catalog，所以为了让用户可以创建自己的编目数据集，必须为用户创建 ALIAS，ALIAS 指向 User Catalog）。</p>
<ol>
<li>
<p>为 TSOxx07 创建别名</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>DEFINE ALIAS(NAME(TSO1607) RELATE('CATALOG.UCAT.STGRP'))
</code></pre>
</div>
</li>
<li>
<p>为 TSOxx08 创建别名</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>DEFINE ALIAS(NAME(TSO1608) RELATE('CATALOG.UCAT.STGRP'))
</code></pre>
</div>
</li>
</ol>
<p> </p>
<h2 id="_7-使用-jcl-执行-racf-命令"><a aria-hidden="true" tabindex="-1" class="header-anchor" href="#_7-使用-jcl-执行-racf-命令">#</a>7. 使用 JCL 执行 RACF 命令</h2>
<p>编写 JCL 作业，然后 SUBMIT：</p>
<p></p><div class="language-"><span class="lang"></span><p></p>
<pre><code>//ST016R1 JOB CLASS=A,MSGLEVEL=(1,1),MSGCLASS=H,
// NOTIFY=ST016
//SEND EXEC PGM=IKJEFT01
//SYSPRINT DD DUMMY
//SYSTSPRT DD SYSOUT=*
//SYSTSIN DD *
SEARCH CLASS(GROUP) MASK(DIV16)
SEARCH CLASS(GROUP) MASK(FUN16)
SEARCH CLASS(GROUP) MASK(RES16)
SEARCH CLASS(USER) MASK(TSO16)
LG FUN16PRD
LG FUN16TST
LG FUN16SP
LG FUN16AP
SEARCH CLASS(DATASET) MASK(TSO16)
SEARCH CLASS(DATASET) MASK(RES16)
LISTDSD DA(TSO1601.**) AU
SEARCH CLASS(TSOPROC) FILTER(PROC#%16)
RLIST TSOPROC PROC#S16 AU
RLIST TSOPROC PROC#A16 AU
SEARCH CLASS(ACCTNUM) FILTER(ACCT#%16)
RLIST ACCTNUM ACCT#S16 AU
RLIST ACCTNUM ACCT#A16 AU
</code></pre>
</div> </div> <div class="grid md:grid-cols-2 text-[0.95em]" data-astro-cid-gvpn4u4b> <a href="https://github.com/Renovamen/renovamen.github.io/edit/main/src/content/blog/zh/2019-04-03-racf-experiment.md" title="Edit link" target="_blank" rel="noopener noreferrer" class="hover:underline" data-astro-cid-gvpn4u4b> <span class="i-tabler:edit w-4.5 h-4.5 align-text-top mr-1" data-astro-cid-gvpn4u4b></span> Edit this page on GitHub </a> <span md:text-right text-c-light data-astro-cid-gvpn4u4b> <span class="i-ic:round-update w-4.5 h-4.5 mr-1" data-astro-cid-gvpn4u4b></span> Last updated:  3/7/2023, 2:57:21 PM </span> </div> <div class="mt-3 pt-3 text-[0.95em]" grid="~ md:cols-2" border="t c" data-astro-cid-gvpn4u4b> <span class="prev" data-astro-cid-gvpn4u4b> <a href="/posts/zh/2019-02-15-rnn-with-its-friends" class="!text-c" data-astro-cid-gvpn4u4b> RNN 和它的朋友们 </a> </span> <span class="next text-right" data-astro-cid-gvpn4u4b> <a href="/posts/zh/2019-07-06-last-three-years" class="!text-c" data-astro-cid-gvpn4u4b> 对过去三年的碎碎念：像样的麻婆豆腐是这个令人讨厌的世界上的唯一的光 </a> </span> </div><div mt-20 data-astro-cid-gvpn4u4b> <script>(()=>{var r=(i,c,s)=>{let n=async()=>{await(await i())()},t=new IntersectionObserver(e=>{for(let o of e)if(o.isIntersecting){t.disconnect(),n();break}});for(let e of s.children)t.observe(e)};(self.Astro||(self.Astro={})).visible=r;window.dispatchEvent(new Event("astro:visible"));})();</script><astro-island uid="Zm61JN" data-solid-render-id="s1" component-url="/_astro/Giscus.tVqIKjcE.js" component-export="default" renderer-url="/_astro/client.DKOYneLd.js" props="{&quot;data-astro-cid-gvpn4u4b&quot;:[0,true]}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;Giscus&quot;,&quot;value&quot;:true}" await-children=""><div data-hk="s10-0" class="giscus"></div><!--astro:end--></astro-island> </div>  </div> </div> <footer class="max-w-content w-full hstack justify-between font-ui mx-auto mt-20" text="xs lg:sm" data-astro-cid-sz7xmlte> <span text-c-lighter data-astro-cid-sz7xmlte> <span data-astro-cid-sz7xmlte>© Xiaohan Zou 2024</span> <span lt-sm:hidden data-astro-cid-sz7xmlte>· A dragon lost in human world</span> </span> <span hstack space-x-3 data-astro-cid-sz7xmlte> <a class="footer-item" href="https://github.com/Renovamen/renovamen.github.io" title="Source code" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <div i-lucide:code-2 data-astro-cid-sz7xmlte></div> <span lt-sm:hidden data-astro-cid-sz7xmlte>Code</span> </a> <a class="footer-item" href="/rss.xml" title="RSS" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <div i-heroicons:rss-20-solid data-astro-cid-sz7xmlte></div> <span lt-sm:hidden data-astro-cid-sz7xmlte>RSS</span> </a> <a class="footer-item" href="/sitemap-index.xml" title="Sitemap" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <div i-bx:map-alt data-astro-cid-sz7xmlte></div> <span lt-sm:hidden data-astro-cid-sz7xmlte>Sitemap</span> </a> </span> </footer>  </main> </body></html>  